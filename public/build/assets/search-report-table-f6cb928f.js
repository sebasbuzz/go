import{j as t,c as v,r as m,bw as ut,y as be,h as K,a5 as se,R as O,bl as re,cg as oe,bE as mt,ch as Ke,X as ft,bd as es,i as E,a8 as _e,T as b,ac as G,aR as xt,aa as Ie,ab as Q,aG as ge,ad as _,ae as J,af as le,ag as Y,aH as Pe,ai as ie,as as ht,b2 as ts,bo as je,aP as Re,m as me,bu as ss,a3 as k,p as ae,q as $e,a4 as Oe,I as Z,S as W,bL as Ue,bM as pt,bN as bt,bi as ne,ci as as,cj as ns,ck as gt,cl as ee,cm as Ae,cn as Te,co as ue,cp as fe,cq as xe,cr as he,cs as jt,bt as ce,c4 as Fe,c5 as te,ct as rs,cu as os,cv as ls,cw as is,cx as cs,cy as ds,cz as us,c6 as Se,b8 as ms,b4 as fs,b as xs,bI as hs,c2 as yt,cA as ps,z as He,aS as bs,cB as gs,cC as js,cD as et,cE as tt,bf as vt,bg as wt,bV as ys,ak as vs,c3 as De,aQ as We,$ as ws,cF as ks,cG as Cs,cH as Ss,bc as Ds,cI as Ns,bX as Is,cJ as Ps,C as Qe,aN as Rs,b_ as $s,f as ye,a1 as ve,a2 as Ve,aF as Ze,ax as Fs,ap as Vs,aq as zs,a0 as kt,Y as Ct,bb as As,s as St,aj as Dt,k as Nt,au as Ts,cc as Ls,at as Es,n as Ms,v as Os,Z as Hs,cK as Bs,J as qs,K as Ks,M as _s}from"./main-e7ef070d.js";import{j as we,h as Ge,s as st,R as Us,g as Ws}from"./reply-editor-41efed28.js";import{E as It}from"./Edit-b7607853.js";function Qs({className:e,children:s,size:a,color:n,radius:r,selectable:o,wrap:l=!0}){return t.jsx("div",{className:v("flex items-center gap-8",l&&"flex-wrap",e),children:m.Children.map(s,i=>{if(m.isValidElement(i))return m.cloneElement(i,{size:a,color:n,selectable:o,radius:r})})})}function Zs({query:e}){return e.fetchStatus==="fetching"?t.jsx(ut,{isIndeterminate:!0,size:"xs",className:"fixed left-0 right-0 top-0"}):null}function er(e){return be({queryKey:["tags",e],queryFn:()=>Gs(e)})}function Gs(e){return K.get("tags",{params:{paginate:"simple",...e}}).then(s=>s.data)}const Js=se(t.jsx("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"}),"DeleteOutlined"),Je=O.createContext(null);function tr(e){const{size:s="md",children:a,className:n,isLazy:r,overflow:o="overflow-hidden"}=e,l=m.useRef([]),i=m.useId(),[c,u]=re(e.selectedTab,e.defaultSelectedTab||0,e.onTabChange),d=m.useMemo(()=>({selectedTab:c,setSelectedTab:u,tabsRef:l,size:s,isLazy:r,id:i}),[c,i,r,u,s]);return t.jsx(Je.Provider,{value:d,children:t.jsx("div",{className:v(n,o,"max-w-full"),children:a})})}function sr({index:e,className:s,isDisabled:a,children:n,padding:r,elementType:o="button",to:l,relative:i,width:c="min-w-min"}){const{selectedTab:u,setSelectedTab:d,tabsRef:f,size:h="md",id:x}=m.useContext(Je),j=e===u,g=oe(),I=r||(h==="sm"?"px-12":"px-18"),N=v("tracking-wide overflow-hidden capitalize text-sm flex items-center justify-center outline-none transition-colors","focus-visible:ring focus-visible:ring-2 ring-inset rounded whitespace-nowrap cursor-pointer",c,Ys({isDisabled:a,isSelected:j}),s,h==="md"&&`${I} h-48`,h==="sm"&&`${I} h-32`,a&&"pointer-events-none"),R=F=>{switch(F.key){case"ArrowLeft":g==null||g.focusPrevious();break;case"ArrowRight":g==null||g.focusNext();break;case"Home":g==null||g.focusFirst();break;case"End":g==null||g.focusLast();break}},C=j?0:-1,w=o;return t.jsx(w,{disabled:a,id:`${x}-${e}-tab`,"aria-controls":`${x}-${e}-tabpanel`,type:"button",role:"tab","aria-selected":j,tabIndex:a?void 0:C,onKeyDown:R,onClick:()=>{d(e)},to:l,relative:i,className:N,ref:F=>{f.current&&F&&(f.current[e]=F)},children:n})}function Ys({isDisabled:e,isSelected:s}){return e?"text-disabled cursor-default":s?"text-primary":"text-muted hover:text-main"}function Xs(){const{tabsRef:e,selectedTab:s}=m.useContext(Je),[a,n]=m.useState({width:void 0,transform:void 0,className:void 0});return mt(()=>{if(s!=null&&e.current){const r=e.current[s];if(!r)return;n(o=>({width:`${r.offsetWidth}px`,transform:`translateX(${r.offsetLeft}px)`,className:o.width===void 0?"":"transition-all"}))}},[n,s,e]),t.jsx("div",{className:v("absolute bottom-0 left-0 h-2 bg-primary",a.className),role:"presentation",style:{width:a.width,transform:a.transform}})}function ar({children:e,center:s,expand:a,className:n}){const r=m.Children.toArray(e);return t.jsx(Ke,{children:t.jsxs("div",{className:v("flex relative max-w-full overflow-auto border-b max-sm:hidden-scrollbar md:compact-scrollbar",n),role:"tablist","aria-orientation":"horizontal",children:[r.map((o,l)=>m.isValidElement(o)?m.cloneElement(o,{index:l,className:v(o.props.className,a&&"flex-auto",s&&l===0&&"ml-auto",s&&l===r.length-1&&"mr-auto")}):null),t.jsx(Xs,{})]})})}const Ce="filters";function ea(e){if(!e)return[];let s=[];try{s=JSON.parse(atob(decodeURIComponent(e))),s.map(a=>(a.valueKey!=null&&(a.value=a.valueKey),a))}catch{}return s}function ta(e,s){return!e||(e=s?e.filter(a=>a.value!=="").map(a=>sa(a,s)):e,e=e.filter(a=>!a.isInactive),!e.length)?"":encodeURIComponent(btoa(JSON.stringify(e)))}function sa(e,s){var n;const a=s.find(r=>r.key===e.key);if((a==null?void 0:a.control.type)==="select"){const r=(a.control.options||[]).find(o=>o.key===e.value);if(r)return{...e,value:r.value,valueKey:r.key}}return(n=a==null?void 0:a.extraFilters)!=null&&n.length&&(e.extraFilters=a.extraFilters),e}function ze(e,s){const[a]=ft(),n=es(),r=a.get(Ce),o=m.useMemo(()=>{if(!e)return[];const d=ea(r);return(s||[]).forEach(f=>{if(!d.find(h=>h.key===f)){const h=e.find(x=>x.key===f);d.push({key:f,value:h.control.defaultValue,operator:h.defaultOperator,isInactive:!0})}}),d.sort((f,h)=>e.findIndex(x=>x.key===f.key)-e.findIndex(x=>x.key===h.key)),d},[r,s,e]),l=m.useCallback(d=>{const f=[...o];return d.forEach(h=>{const x=typeof h=="object"?h.key:h,j=f.findIndex(g=>g.key===x);j>-1&&f.splice(j,1)}),f},[o]),i=m.useCallback(d=>{const f=ta(d,e);f?a.set(Ce,f):a.delete(Ce),n({search:`?${a}`},{replace:!0})},[e,n,a]),c=m.useCallback(d=>{const h=[...l(d),...d];i(h)},[l,i]),u=m.useCallback(d=>i(l([d])),[l,i]);return{add:c,remove:u,replaceAll:i,decodedFilters:o,encodedFilters:r}}var L=(e=>(e.Select="select",e.DateRangePicker="dateRangePicker",e.SelectModel="selectModel",e.Input="input",e.BooleanToggle="booleanToggle",e.ChipField="chipField",e.Custom="custom",e))(L||{}),Ne=(e=>(e.eq="=",e.ne="!=",e.gt=">",e.gte=">=",e.lt="<",e.lte="<=",e.has="has",e.hasAll="hasAll",e.doesntHave="doesntHave",e.between="between",e))(Ne||{});const Pt=m.forwardRef((e,s)=>{const{isInactive:a,filter:n,...r}=e;return a?t.jsx(aa,{filter:n,...r,ref:s}):t.jsx(na,{filter:n,...r,ref:s})}),aa=m.forwardRef(({filter:e,...s},a)=>t.jsx(E,{variant:"outline",size:"xs",color:"paper",radius:"rounded-md",border:"border",ref:a,endIcon:t.jsx(_e,{}),...s,children:t.jsx(b,{...e.label})})),na=m.forwardRef(({filter:e,children:s,...a},n)=>{const r=e.control.type===L.BooleanToggle;return t.jsxs(E,{variant:"outline",size:"xs",color:"primary",radius:"rounded-r-md",border:"border-y border-r",endIcon:!r&&t.jsx(_e,{}),ref:n,...a,children:[t.jsx("span",{className:v(!r&&"border-r border-r-primary-light mr-8 pr-8"),children:t.jsx(b,{...e.label})}),s]})});function Rt({filter:e}){const{trans:s}=G();return t.jsx(xt,{size:"sm",name:`${e.key}.value`,selectionMode:"single",showSearchField:e.control.showSearchField,placeholder:e.control.placeholder?s(e.control.placeholder):void 0,searchPlaceholder:e.control.searchPlaceholder?s(e.control.searchPlaceholder):void 0,children:e.control.options.map(a=>t.jsx(Ie,{value:a.key,children:t.jsx(b,{...a.label})},a.key))})}function ke(e){const{onValueChange:s,isInactive:a,filter:n,label:r}=e;return t.jsxs(Q,{offset:10,type:"popover",onClose:o=>{o!==void 0&&s(o)},children:[t.jsx(Pt,{isInactive:a,filter:n,children:r}),t.jsx(ra,{...e})]})}function ra({filter:e,panel:s,value:a,operator:n}){const r=ge({defaultValues:{[e.key]:{value:a,operator:n}}}),{close:o,formId:l}=_();return t.jsxs(J,{size:"xs",children:[t.jsx(le,{children:t.jsx(b,{...e.label})}),t.jsx(Y,{padding:"px-14 pt-14 pb-4 max-h-288",children:t.jsxs(Pe,{form:r,id:l,onSubmit:i=>{o(i[e.key])},children:[e.description&&t.jsx("div",{className:"text-muted text-xs mb-14",children:t.jsx(b,{...e.description})}),s]})}),t.jsx(ie,{children:t.jsx(E,{form:l,type:"submit",variant:"flat",color:"primary",size:"xs",children:t.jsx(b,{message:"Apply"})})})]})}function oa(e,s,a){return be({queryKey:[e,s],queryFn:()=>la(e,s),placeholderData:ht,...a})}async function la(e,s){return K.get(e,{params:s}).then(a=>a.data)}function $t(e,s,a){return be({queryKey:[e,s],queryFn:()=>ia(e,s),...a})}async function ia(e,s){return K.get(e,{params:s}).then(a=>a.data)}function ca({label:e,className:s,background:a,value:n,defaultValue:r="",placeholder:o=k("Select item..."),searchPlaceholder:l=k("Find an item..."),onChange:i,description:c,errorMessage:u,invalid:d,autoFocus:f,queryParams:h,endpoint:x,disabled:j,required:g}){var P;const I=m.useRef(null),[N,R]=m.useState(""),[C,w]=re(n,r,i),F=oa(x,{query:N,...h}),{trans:$}=G(),p=Re({size:"md"});return C?t.jsxs("div",{className:s,children:[t.jsx("div",{className:p.label,children:e}),t.jsx("div",{className:v("rounded-input border p-8",a,d&&"border-danger"),children:t.jsx(me,{initial:!1,mode:"wait",children:t.jsx(da,{disabled:j,endpoint:x,modelId:C,queryParams:h,onEditClick:()=>{w(""),R(""),requestAnimationFrame(()=>{var S,V;(S=I.current)==null||S.focus(),(V=I.current)==null||V.click()})}})})}),c&&!u&&t.jsx("div",{className:p.description,children:c}),u&&t.jsx("div",{className:p.error,children:u})]}):t.jsx(ss,{className:s,showSearchField:!0,invalid:d,errorMessage:u,description:c,color:"white",isAsync:!0,background:a,placeholder:$(o),searchPlaceholder:$(l),label:e,isLoading:F.isFetching,items:(P=F.data)==null?void 0:P.results,inputValue:N,onInputValueChange:R,selectionMode:"single",selectedValue:C,onSelectionChange:w,ref:I,autoFocus:f,disabled:j,required:g,children:S=>t.jsx(Ie,{value:S.id,description:S.description,startIcon:t.jsx(we,{src:S.image}),children:S.name},S.id)})}function da({modelId:e,onEditClick:s,endpoint:a,disabled:n,queryParams:r}){const{data:o,isLoading:l}=$t(`${a}/${e}`,r);return l||!(o!=null&&o.model)?t.jsx(ua,{},"skeleton"):t.jsxs(ae.div,{className:v("flex items-center gap-10",n&&"pointer-events-none cursor-not-allowed text-disabled"),...$e,children:[o.model.image&&t.jsx(we,{src:o.model.image}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm leading-4",children:o.model.name}),t.jsx("div",{className:"text-xs text-muted",children:o.model.description})]}),t.jsx(Oe,{label:t.jsx(b,{message:"Change item"}),children:t.jsx(Z,{className:"ml-auto text-muted",size:"sm",onClick:s,disabled:n,children:t.jsx(It,{})})})]},"preview")}function ua(){return t.jsxs(ae.div,{className:"flex items-center gap-10",...$e,children:[t.jsx(W,{variant:"rect",size:"w-32 h-32"}),t.jsxs("div",{className:"max-h-[36px] flex-auto",children:[t.jsx(W,{className:"text-xs"}),t.jsx(W,{className:"max-h-8 text-xs"})]}),t.jsx(W,{variant:"icon",size:"w-24 h-24"})]})}function ma({name:e,...s}){const{clearErrors:a}=ts(),{field:{onChange:n,value:r=""},fieldState:{invalid:o,error:l}}=je({name:e});return t.jsx(ca,{value:r,onChange:i=>{n(i),a(e)},invalid:o,errorMessage:l==null?void 0:l.message,...s})}function Ft({filter:e}){return t.jsx(ma,{name:`${e.key}.value`,endpoint:`normalized-models/${e.control.model}`})}const Vt=se(t.jsx("path",{d:"M7 11h2v2H7v-2zm14-5v14c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2l.01-14c0-1.1.88-2 1.99-2h1V2h2v2h8V2h2v2h1c1.1 0 2 .9 2 2zM5 8h14V6H5v2zm14 12V10H5v10h14zm-4-7h2v-2h-2v2zm-4 0h2v-2h-2v2z"}),"DateRangeOutlined"),zt=O.forwardRef((e,s)=>{const{children:a,inputProps:n,wrapperProps:r,className:o,autoFocus:l,style:i,onClick:c}=e;return t.jsx("div",{...r,onClick:c,children:t.jsx("div",{...n,role:"group",className:v(o,"flex items-center focus-within:ring focus-within:ring-primary/focus focus-within:border-primary/60"),ref:s,style:i,children:t.jsx(Ke,{autoFocus:l,children:a})})})}),Ye=O.forwardRef(({inputRef:e,wrapperProps:s,children:a,onBlur:n,...r},o)=>{const l=Re(r),i=Ue(o),{fieldProps:c,inputProps:u}=pt({...r,focusRef:i,labelElementType:"span"});return l.wrapper=v(l.wrapper,r.disabled&&"pointer-events-none"),t.jsx(bt,{wrapperProps:ne(s,{onBlur:d=>{i.current&&!i.current.contains(d.relatedTarget)&&(n==null||n(d))},onClick:()=>{const d=as(i);d==null||d.focusFirst()}}),fieldClassNames:l,ref:i,...c,children:t.jsx(zt,{inputProps:u,className:v(l.input,"gap-10"),ref:e,children:a})})});function fa(e){return e instanceof ns?"day":"minute"}function Be(e,s,a){return s!=null&&e.compare(s)<0||a!=null&&e.compare(a)>0}function At(e,s){const a=gt(),[n,r]=m.useState(!1),o=s.closeDialogOnSelection??!0,l=s.granularity||fa(e),i=s.min?ee(s.min,a):void 0,c=s.max?ee(s.max,a):void 0;return{timezone:a,granularity:l,min:i,max:c,calendarIsOpen:n,setCalendarIsOpen:r,closeDialogOnSelection:o}}function Tt(e){return e.set({hour:0,minute:0,second:0,millisecond:0})}function q(e){return e.set({hour:24-1,minute:60-1,second:60-1,millisecond:1e3-1})}function xa(e){var U,X;const s=Ge(),[a,n]=m.useState({start:(!e.value||!e.value.start)&&!((U=e.defaultValue)!=null&&U.start),end:(!e.value||!e.value.end)&&!((X=e.defaultValue)!=null&&X.end)}),r=e.onChange,[o,l]=re(e.value?Ee(e.value,s):void 0,e.value?void 0:Ee(e.defaultValue,s),y=>{n({start:!1,end:!1}),r==null||r(y)}),{min:i,max:c,granularity:u,timezone:d,calendarIsOpen:f,setCalendarIsOpen:h,closeDialogOnSelection:x}=At(o.start,e),j=m.useCallback(()=>{n({start:!0,end:!0}),l(Ee(null,s)),r==null||r(null),h(!1)},[s,l,r,h]),[g,I]=m.useState(null),[N,R]=m.useState(!1),[C,w]=m.useState(o),[F,$]=m.useState(()=>at(o,c)),p=m.useCallback(y=>{let D=y.start,z=y.end;i&&(D=Ae(D,i));const H=c?Te(c,z):z;D=Te(D,H);const de=i?Ae(i,D):D;return z=Ae(z,de),c&&(z=Te(z,c)),{start:ee(D,d),end:ee(z,d)}},[i,c,d]),P=m.useCallback(y=>{const D={...p(y),preset:y.preset};l(D),w(D),$(at(D,c)),n({start:!1,end:!1})},[l,p,c]),S=m.useCallback(y=>!a.start&&ue(y,C.start)||!a.end&&ue(y,C.end),[C,a]),V=m.useCallback(y=>(N||!a.start&&!a.end)&&y.compare(C.start)>=0&&y.compare(C.end)<=0,[C,a,N]),T=m.useCallback(y=>ue(y,C.start),[C]),M=m.useCallback(y=>ue(y,C.end),[C]),B=m.useCallback((y,D)=>({onPointerEnter:()=>{N&&D&&w(Le({start:g,end:y,timezone:d}))},onClick:()=>{if(!N)R(!0),I(y),w(Le({start:y,end:y,timezone:d}));else{const z=Le({start:g,end:y,timezone:d});z.start=Tt(z.start),z.end=q(z.end),R(!1),I(null),P==null||P(z),x&&(h==null||h(!1))}}}),[g,N,P,h,x,d]);return{selectedValue:o,setSelectedValue:P,calendarIsOpen:f,setCalendarIsOpen:h,dayIsActive:S,dayIsHighlighted:V,dayIsRangeStart:T,dayIsRangeEnd:M,getCellProps:B,calendarDates:F,setIsPlaceholder:n,isPlaceholder:a,clear:j,setCalendarDates:$,min:i,max:c,granularity:u,timezone:d,closeDialogOnSelection:x}}function at(e,s){let a=fe(xe(e.start)),n=fe(he(e.end));return jt(a,n)&&(n=he(n.add({months:1}))),s&&n.compare(s)>0&&(n=a,a=xe(a.subtract({months:1}))),[a,n]}function Le(e){const s=ee(e.start,e.timezone),a=ee(e.end,e.timezone);return s.compare(a)>0?{start:a,end:s}:{start:s,end:a}}function Ee(e,s){return e!=null&&e.start&&(e!=null&&e.end)?e:!(e!=null&&e.start)&&(e!=null&&e.end)?(e.start=e.end.subtract({months:1}),e):!(e!=null&&e.end)&&(e!=null&&e.start)?(e.end=e.start.add({months:1}),e):{start:s,end:s.add({months:1})}}const Lt=se(t.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4v3z"}),"ArrowRightAltOutlined");function ha(e,s,a,n){switch(s){case"era":case"year":case"month":case"day":return e.cycle(s,a,{round:s==="year"})}if("hour"in e)switch(s){case"dayPeriod":{const r=e.hour,o=r>=12;return e.set({hour:o?r-12:r+12})}case"hour":case"minute":case"second":return e.cycle(s,a,{round:s!=="hour",hourCycle:n.hour12?12:24})}return e}function pa(e,s,a,n){switch(s){case"day":case"month":case"year":return e.set({[s]:a})}if("hour"in e)switch(s){case"dayPeriod":{const r=e.hour,o=r>=12;return a>=12===o?e:e.set({hour:o?r-12:r+12})}case"hour":if(n.hour12){const o=e.hour>=12;!o&&a===12&&(a=0),o&&a<12&&(a+=12)}case"minute":case"second":return e.set({[s]:a})}return e}const nt={year:5,month:2,day:7,hour:2,minute:15,second:15,dayPeriod:1};function ba({segment:e,domProps:s,value:a,onChange:n,isPlaceholder:r,state:{timezone:o,calendarIsOpen:l,setCalendarIsOpen:i}}){const c=ce(),u=m.useRef(""),{localeCode:d}=Fe(),f=oe(),h=te({timeZone:o}),x=m.useMemo(()=>new rs(d,{maximumFractionDigits:0}),[d]),j=p=>{n(pa(a,e.type,p,h.resolvedOptions()))},g=p=>{n(ha(a,e.type,p,h.resolvedOptions()))},I=()=>{if(x.isValidPartialNumber(e.text)){const p=e.text.slice(0,-1),P=x.parse(p);if(p.length===0||P===0){const S=os(o);e.type in S&&j(S[e.type])}else j(P);u.current=p}else e.type==="dayPeriod"&&g(-1)},N=p=>{var P;if(!(p.ctrlKey||p.metaKey||p.shiftKey||p.altKey)){switch(p.key){case"ArrowLeft":p.preventDefault(),p.stopPropagation(),f==null||f.focusPrevious();break;case"ArrowRight":p.preventDefault(),p.stopPropagation(),f==null||f.focusNext();break;case"Enter":(P=p.target.closest("form"))==null||P.requestSubmit(),i(!l);break;case"Tab":break;case"Backspace":case"Delete":{p.preventDefault(),p.stopPropagation(),I();break}case"ArrowUp":p.preventDefault(),u.current="",g(1);break;case"ArrowDown":p.preventDefault(),u.current="",g(-1);break;case"PageUp":p.preventDefault(),u.current="",g(nt[e.type]||1);break;case"PageDown":p.preventDefault(),u.current="",g(-(nt[e.type]||1));break;case"Home":p.preventDefault(),u.current="",j(e.maxValue);break;case"End":p.preventDefault(),u.current="",j(e.minValue);break}F(p.key)}},R=te({hour:"numeric",hour12:!0}),C=m.useMemo(()=>{const p=new Date;return p.setHours(0),R.formatToParts(p).find(P=>P.type==="dayPeriod").value},[R]),w=m.useMemo(()=>{const p=new Date;return p.setHours(12),R.formatToParts(p).find(P=>P.type==="dayPeriod").value},[R]),F=p=>{const P=u.current+p;switch(e.type){case"dayPeriod":if(C.toLowerCase().startsWith(p))j(0);else if(w.toLowerCase().startsWith(p))j(12);else break;f==null||f.focusNext();break;case"day":case"hour":case"minute":case"second":case"month":case"year":{if(!x.isValidPartialNumber(P))return;let S=x.parse(P),V=S,T=e.minValue===0;if(e.type==="hour"&&h.resolvedOptions().hour12){switch(h.resolvedOptions().hourCycle){case"h11":S>11&&(V=x.parse(p));break;case"h12":T=!1,S>12&&(V=x.parse(p));break}e.value>=12&&S>1&&(S+=12)}else S>e.maxValue&&(V=x.parse(p));if(Number.isNaN(S))return;const M=V!==0||T;M&&j(V),+`${S}0`>e.maxValue||P.length>=String(e.maxValue).length?(u.current="",M&&(f==null||f.focusNext())):u.current=P;break}}},$=c?{}:{"aria-label":e.type,"aria-valuetext":r?void 0:`${e.value}`,"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":r?void 0:e.value,tabIndex:0,onKeyDown:N};return t.jsx("div",{...ne(s,{...$,onFocus:p=>{u.current="",p.target.scrollIntoView({block:"nearest"})},onClick:p=>{p.preventDefault(),p.stopPropagation()}}),className:"box-content cursor-default select-none whitespace-nowrap rounded p-2 text-center tabular-nums caret-transparent outline-none focus:bg-primary focus:text-on-primary",children:e.text.padStart(e.minLength,"0")})}function ga({segment:e,domProps:s}){const a=oe();return t.jsx("div",{...s,onPointerDown:n=>{n.pointerType==="mouse"&&(n.preventDefault(),a!=null&&a.focusNext({from:n.target})||a==null||a.focusPrevious({from:n.target}))},"aria-hidden":!0,className:"min-w-4 cursor-default select-none",children:e.text})}function ja(e,s,a){switch(s){case"year":return{value:e.year,placeholder:"yyyy",minValue:1,maxValue:e.calendar.getYearsInEra(e)};case"month":return{value:e.month,placeholder:"mm",minValue:is(e),maxValue:e.calendar.getMonthsInYear(e)};case"day":return{value:e.day,minValue:ls(e),maxValue:e.calendar.getDaysInMonth(e),placeholder:"dd"}}if("hour"in e)switch(s){case"dayPeriod":return{value:e.hour>=12?12:0,minValue:0,maxValue:12,placeholder:"--"};case"hour":if(a.hour12){const n=e.hour>=12;return{value:e.hour,minValue:n?12:0,maxValue:n?23:11,placeholder:"--"}}return{value:e.hour,minValue:0,maxValue:23,placeholder:"--"};case"minute":return{value:e.minute,minValue:0,maxValue:59,placeholder:"--"}}return{}}function pe({segmentProps:e,state:s,value:a,onChange:n,isPlaceholder:r}){const{granularity:o}=s,l=m.useMemo(()=>{const d={year:"numeric",month:"numeric",day:"numeric"};return o==="minute"&&(d.hour="numeric",d.minute="numeric"),d},[o]),i=te(l),c=m.useMemo(()=>a.toDate(),[a]),u=m.useMemo(()=>i.formatToParts(c).map(d=>{const f=ja(a,d.type,i.resolvedOptions()),h=r&&d.type!=="literal"?f.placeholder:d.value;return{type:d.type,text:d.value===", "?" ":h,...f,minLength:d.type!=="literal"?String(f.maxValue).length:1}}),[c,i,r,a]);return t.jsx("div",{className:"flex items-center",children:u.map((d,f)=>d.type==="literal"?t.jsx(ga,{domProps:e,segment:d},f):t.jsx(ba,{isPlaceholder:r,domProps:e,state:s,value:a,onChange:n,segment:d},f))})}function ya({date:e,currentMonth:s,state:{dayIsActive:a,dayIsHighlighted:n,dayIsRangeStart:r,dayIsRangeEnd:o,getCellProps:l,timezone:i,min:c,max:u}}){const{localeCode:d}=Fe(),f=cs(e,d),h=a(e),x=n(e),j=r(e),g=o(e),I=ds(e,i),N=jt(e,s),R=Be(e,c,u);return t.jsxs("div",{role:"button","aria-disabled":R,className:v("w-40 h-40 text-sm relative isolate flex-shrink-0",R&&"text-disabled pointer-events-none",!N&&"invisible pointer-events-none"),...l(e,N),children:[t.jsx("span",{className:v("absolute inset-0 flex items-center justify-center rounded-full w-full h-full select-none z-10 cursor-pointer",!h&&!I&&"hover:bg-hover",h&&"bg-primary text-on-primary font-semibold",I&&!h&&"bg-chip"),children:e.day}),x&&N&&t.jsx("span",{className:v("absolute w-full h-full inset-0 bg-primary/focus",(j||f===0||e.day===1)&&"rounded-l-full",(g||f===6||e.day===s.calendar.getDaysInMonth(s))&&"rounded-r-full")})]})}function va({startDate:e,state:s,isFirst:a,isLast:n}){const{localeCode:r}=Fe(),o=us(e,r),l=Se(e,r);return t.jsxs("div",{className:"w-280 flex-shrink-0",children:[t.jsx(wa,{isFirst:a,isLast:n,state:s,currentMonth:e}),t.jsxs("div",{className:"block",role:"grid",children:[t.jsx(ka,{state:s,startDate:e}),[...new Array(o).keys()].map(i=>t.jsx(ae.div,{className:"flex mb-6",children:[...new Array(7).keys()].map(c=>t.jsx(ya,{date:l.add({weeks:i,days:c}),currentMonth:e,state:s},c))},i))]})]})}function wa({currentMonth:e,isFirst:s,isLast:a,state:{calendarDates:n,setCalendarDates:r,timezone:o,min:l,max:i}}){const c=h=>{const x=n.length;let j;h==="forward"?j=n.map(g=>he(g.add({months:x}))):j=n.map(g=>he(g.subtract({months:x}))),r(j)},u=te({month:"long",year:"numeric",era:e.calendar.identifier!=="gregory"?"long":void 0,calendar:e.calendar.identifier}),d=Be(e.subtract({days:1}),l,i),f=Be(xe(e.add({months:1})),l,i);return t.jsxs("div",{className:"flex items-center justify-between gap-10",children:[t.jsx(Z,{size:"md",className:v("text-muted",!s&&"invisible"),disabled:!s||d,"aria-hidden":!s,onClick:()=>{c("backward")},children:t.jsx(ms,{})}),t.jsx("div",{className:"text-sm font-semibold select-none",children:u.format(e.toDate(o))}),t.jsx(Z,{size:"md",className:v("text-muted",!a&&"invisible"),disabled:!a||f,"aria-hidden":!a,onClick:()=>{c("forward")},children:t.jsx(fs,{})})]})}function ka({state:{timezone:e},startDate:s}){const{localeCode:a}=Fe(),n=te({weekday:"short"}),r=Se(s,a);return t.jsx("div",{className:"flex",children:[...new Array(7).keys()].map(o=>{const i=r.add({days:o}).toDate(e),c=n.format(i);return t.jsx("div",{className:"w-40 h-40 text-sm font-semibold relative flex-shrink-0",children:t.jsx("div",{className:"absolute flex items-center justify-center w-full h-full select-none",children:c})},o)})})}function Et({state:e,visibleMonths:s=1}){return ce()&&(s=1),t.jsx(m.Fragment,{children:[...new Array(s).keys()].map(n=>{const r=fe(xe(e.calendarDates[n])),o=n===0,l=n===s-1;return t.jsx(va,{state:e,startDate:r,isFirst:o,isLast:l},n)})})}const Mt=m.memo(({start:e,end:s,options:a,preset:n})=>{const{dates:r}=xs(),o=gt(),l=te(a||hs[n||(r==null?void 0:r.format)]);if(!e||!s)return null;let i;try{i=l.formatRange(rt(e,o),rt(s,o))}catch{i=""}return t.jsx(m.Fragment,{children:i})},yt);function rt(e,s){return typeof e=="string"?ps(e,s).toDate():"toDate"in e?e.toDate(s):e}function Ca(){var a,n,r;const e=(a=He())==null?void 0:a.settings.dates.default_timezone,s=((r=(n=He())==null?void 0:n.user)==null?void 0:r.timezone)||e||"auto";return!s||s==="auto"?bs():s}const A=Tt(gs(Ca()));var ct,dt;const Me=((dt=(ct=He())==null?void 0:ct.i18n)==null?void 0:dt.language)||"en",Xe=[{key:0,label:k("Today"),getRangeValue:()=>({preset:0,start:A,end:q(A)})},{key:1,label:k("Yesterday"),getRangeValue:()=>({preset:1,start:A.subtract({days:1}),end:q(A).subtract({days:1})})},{key:2,label:k("This week"),getRangeValue:()=>({preset:2,start:Se(A,Me),end:js(q(A),Me)})},{key:3,label:k("Last week"),getRangeValue:()=>{const e=Se(A,Me).subtract({days:7});return{preset:3,start:e,end:e.add({days:6})}}},{key:4,label:k("Last 7 days"),getRangeValue:()=>({preset:4,start:A.subtract({days:7}),end:q(A)})},{key:6,label:k("Last 30 days"),getRangeValue:()=>({preset:6,start:A.subtract({days:30}),end:q(A)})},{key:7,label:k("Last 3 months"),getRangeValue:()=>({preset:7,start:A.subtract({months:3}),end:q(A)})},{key:8,label:k("Last 12 months"),getRangeValue:()=>({preset:8,start:A.subtract({months:12}),end:q(A)})},{key:9,label:k("This month"),getRangeValue:()=>({preset:9,start:xe(A),end:he(q(A))})},{key:10,label:k("This year"),getRangeValue:()=>({preset:10,start:et(A),end:tt(q(A))})},{key:11,label:k("Last year"),getRangeValue:()=>({preset:11,start:et(A).subtract({years:1}),end:tt(q(A)).subtract({years:1})})}];function Sa({onPresetSelected:e,selectedValue:s}){return t.jsx(vt,{children:Xe.map(a=>t.jsx(wt,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(s==null?void 0:s.preset)===a.key,onSelected:()=>{const n=a.getRangeValue();e(n)},children:t.jsx(b,{...a.label})},a.key))})}function Da(e){return ys("(max-width: 1024px)",e)}const Ot=O.forwardRef((e,s)=>{const{children:a,size:n="sm",description:r,className:o,invalid:l,autoFocus:i,errorMessage:c,...u}=e,d=Ue(s);vs({autoFocus:i},d);const f=Na(n),h=Re(e),x=m.useId();return t.jsxs("div",{className:v(o,"isolate"),children:[t.jsxs("label",{className:"flex items-center select-none",children:[t.jsx("input",{...u,type:"checkbox",role:"switch","aria-invalid":l||void 0,"aria-describedby":r?x:void 0,ref:d,"aria-checked":u.checked,className:v(f,!l&&"checked:bg-primary dark:checked:bg-primary-dark checked:border-primary dark:checked:border-primary-dark",l&&"checked:bg-danger checked:border-danger","outline-none cursor-pointer bg-chip border-chip border checked:bg-primary checked:border-primary p-0 overflow-hidden relative rounded-3xl appearance-none transition-colors flex-shrink-0 flex items-center outline-none","before:z-10 before:border before:rounded-3xl before:block before:bg-white before:transition-transform before:translate-x-2","checked:before:border-white","focus-visible:ring",e.disabled&&"opacity-80 cursor-not-allowed")}),a&&t.jsx("span",{className:v(h.size.font,"ml-12",l&&"text-danger",e.disabled&&"text-disabled"),children:a})]}),r&&!c&&t.jsx("div",{id:x,className:h.description,children:r}),c&&t.jsx("div",{id:x,className:h.error,children:c})]})});function Ht(e){const{field:{onChange:s,onBlur:a,value:n=!1,ref:r},fieldState:{invalid:o,error:l}}=je({name:e.name}),i={onChange:c=>{c.target.value&&c.target.value!=="on"?s(c.target.checked?c.target.value:!1):s(c)},onBlur:a,checked:!!n,invalid:o,errorMessage:l==null?void 0:l.message,name:e.name};return t.jsx(Ot,{ref:r,...ne(e,i)})}function Na(e){switch(e){case"xl":return"w-68 h-36 before:w-28 before:h-28 checked:before:translate-x-36";case"lg":return"w-56 h-30 before:w-22 before:h-22 checked:before:translate-x-30";case"md":return"w-46 h-24 before:w-18 before:h-18 checked:before:translate-x-24";case"xs":return"w-30 h-16 before:w-12 before:h-12 checked:before:translate-x-16";default:return"w-38 h-20 before:w-14 before:h-14 checked:before:translate-x-20"}}const Ia=[{key:0,label:k("Preceding period"),getRangeValue:e=>{const s=e.start,r=(e.end.toDate().getTime()-s.toDate().getTime())/(1e3*60);return{preset:0,start:s.subtract({minutes:r}),end:s}}},{key:1,label:k("Same period last year"),getRangeValue:e=>({start:e.start.subtract({years:1}),end:e.end.subtract({years:1}),preset:1})},{key:2,label:k("Custom"),getRangeValue:e=>({start:e.start.subtract({weeks:1}),end:e.end.subtract({weeks:1}),preset:2})}];function Pa({originalRangeValue:e,onPresetSelected:s,selectedValue:a}){return t.jsx(vt,{children:Ia.map(n=>t.jsx(wt,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(a==null?void 0:a.preset)===n.key,onSelected:()=>{const r=n.getRangeValue(e);s(r)},children:t.jsx(b,{...n.label})},n.key))})}function Ra({state:e,compareState:s,showInlineDatePickerField:a=!1,compareVisibleDefault:n=!1}){const r=Da(),{close:o}=_(),l=m.useRef(e),i=e.isPlaceholder.start||e.isPlaceholder.end,[c,u]=m.useState(n),d=t.jsxs(ie,{dividerTop:!0,startAction:!i&&!r?t.jsx("div",{className:"text-xs",children:t.jsx(Mt,{start:e.selectedValue.start.toDate(),end:e.selectedValue.end.toDate(),options:{dateStyle:"medium"}})}):void 0,children:[t.jsx(E,{variant:"text",size:"xs",onClick:()=>{e.setSelectedValue(l.current.selectedValue),e.setIsPlaceholder(l.current.isPlaceholder),o()},children:t.jsx(b,{message:"Cancel"})}),t.jsx(E,{variant:"flat",color:"primary",size:"xs",onClick:()=>{const f=e.selectedValue;s&&c&&(f.compareStart=s.selectedValue.start,f.compareEnd=s.selectedValue.end),o(f)},children:t.jsx(b,{message:"Select"})})]});return t.jsxs(J,{size:"auto",children:[t.jsxs(Y,{className:"flex",padding:"p-0",children:[!r&&t.jsxs("div",{className:"min-w-192 py-14",children:[t.jsx(Sa,{selectedValue:e.selectedValue,onPresetSelected:f=>{e.setSelectedValue(f),e.closeDialogOnSelection&&o(f)}}),!!s&&t.jsxs(m.Fragment,{children:[t.jsx(Ot,{className:"mx-20 mb-10 mt-14",checked:c,onChange:f=>u(f.target.checked),children:t.jsx(b,{message:"Compare"})}),c&&t.jsx(Pa,{originalRangeValue:e.selectedValue,selectedValue:s.selectedValue,onPresetSelected:f=>{s.setSelectedValue(f)}})]})]}),t.jsx(me,{initial:!1,children:t.jsx($a,{state:e,compareState:s,showInlineDatePickerField:a,compareVisible:c})})]}),!e.closeDialogOnSelection&&d]})}function $a({state:e,compareState:s,showInlineDatePickerField:a,compareVisible:n}){return t.jsxs(ae.div,{initial:{width:0,overflow:"hidden"},animate:{width:"auto"},exit:{width:0,overflow:"hidden"},transition:{type:"tween",duration:.125},className:"border-l px-20 pb-20 pt-10",children:[a&&t.jsxs("div",{children:[t.jsx(ot,{state:e}),!!s&&n&&t.jsx(ot,{state:s,label:t.jsx(b,{message:"Compare"})})]}),t.jsx("div",{className:"flex items-start gap-36",children:t.jsx(Et,{state:e,visibleMonths:2})})]})}function ot({state:e,label:s}){const{selectedValue:a,setSelectedValue:n}=e;return t.jsxs(Ye,{className:"mb-20 mt-10",label:s,children:[t.jsx(pe,{state:e,value:a.start,onChange:r=>{n({...a,start:r})}}),t.jsx(Lt,{className:"block flex-shrink-0 text-muted",size:"md"}),t.jsx(pe,{state:e,value:a.end,onChange:r=>{n({...a,end:r})}})]})}function Fa(e){var h,x;const{granularity:s,closeDialogOnSelection:a,...n}=e,r=xa(e),o=m.useRef(null),i=ce()&&s!=="day",c=t.jsx(Q,{offset:8,placement:"bottom-start",isOpen:r.calendarIsOpen,onOpenChange:r.setCalendarIsOpen,type:"popover",triggerRef:o,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:t.jsx(Ra,{state:r})}),u={onClick:j=>{j.stopPropagation(),j.preventDefault(),Va(j)?r.setCalendarIsOpen(!1):r.setCalendarIsOpen(!0)}},d=r.selectedValue,f=r.setSelectedValue;return t.jsxs(m.Fragment,{children:[t.jsxs(Ye,{ref:o,wrapperProps:u,endAdornment:i?void 0:t.jsx(Vt,{}),...n,children:[t.jsx(pe,{isPlaceholder:(h=r.isPlaceholder)==null?void 0:h.start,state:r,segmentProps:u,value:d.start,onChange:j=>{f({start:j,end:d.end})}}),t.jsx(Lt,{className:"block flex-shrink-0 text-muted",size:"md"}),t.jsx(pe,{isPlaceholder:(x=r.isPlaceholder)==null?void 0:x.end,state:r,segmentProps:u,value:d.end,onChange:j=>{f({start:d.start,end:j})}})]}),c]})}function Va(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}function za(e){const{field:{onChange:s,onBlur:a,value:n,ref:r},fieldState:{invalid:o,error:l}}=je({name:e.name}),i={onChange:c=>{s(c?Bt(c):null)},onBlur:a,value:Aa(n),invalid:o,errorMessage:l==null?void 0:l.message,inputRef:r};return t.jsx(Fa,{...ne(i,e)})}function Aa(e){const{start:s,end:a,preset:n}=e||{},r={preset:n};try{s&&(r.start=typeof s=="string"?De(s):s),a&&(r.end=typeof a=="string"?De(a):a)}catch{}return r}function Bt({start:e,end:s,preset:a}={}){const n={preset:a};return e&&(n.start=e.toAbsoluteString()),s&&(n.end=s.toAbsoluteString()),n}function qt({filter:e}){return t.jsx(za,{min:e.control.min,max:e.control.max,size:"sm",name:`${e.key}.value`,granularity:"day",closeDialogOnSelection:!0})}const Kt={"=":k("is"),"!=":k("is not"),">":k("is greater than"),">=":k("is greater than or equal to"),"<":k("is less than"),"<=":k("is less than or equal to"),has:k("Include"),doesntHave:k("Do not include"),between:k("Is between"),hasAll:k("Include all")};function _t({filter:e}){var a;const s=e.control;return t.jsxs(m.Fragment,{children:[t.jsx(xt,{selectionMode:"single",name:`${e.key}.operator`,className:"mb-14",size:"sm",required:!0,children:(a=e.operators)==null?void 0:a.map(n=>t.jsx(Ie,{value:n,children:t.jsx(b,{...Kt[n]})},n))}),t.jsx(We,{size:"sm",name:`${e.key}.value`,type:e.control.inputType,min:"minValue"in s?s.minValue:void 0,max:"maxValue"in s?s.maxValue:void 0,minLength:"minLength"in s?s.minLength:void 0,maxLength:"maxLength"in s?s.maxLength:void 0,required:!0})]})}function qe(e){return{id:e,name:`${e}`,description:`${e}`}}function Ta(e,s){const a=m.useRef(null),n=Ue(s),{displayWith:r=H=>H.name,validateWith:o,children:l,suggestions:i,isLoading:c,inputValue:u,onInputValueChange:d,onItemSelected:f,placeholder:h,onOpenChange:x,chipSize:j="sm",openMenuOnFocus:g=!0,showEmptyMessage:I,value:N,defaultValue:R,onChange:C,valueKey:w,isAsync:F,allowCustomValue:$=!0,showDropdownArrow:p,onChipClick:P,...S}=e,V=Re({...e,flexibleHeight:!0}),[T,M]=Ma(e),[B,U]=m.useState(!1),X=t.jsx(Ds,{isIndeterminate:!0,size:"sm","aria-label":"loading..."}),y=p?t.jsx(_e,{}):null,{fieldProps:D,inputProps:z}=pt({...S,focusRef:n,endAdornment:c&&B?X:y});return t.jsx(bt,{fieldClassNames:V,...D,children:t.jsxs(zt,{ref:a,className:v("flex flex-wrap items-center",V.input),onClick:()=>{var H;(H=n.current)==null||H.focus()},children:[t.jsx(La,{displayChipUsing:r,onChipClick:P,items:T,setItems:M,chipSize:j}),t.jsx(Ea,{showEmptyMessage:I,inputProps:z,inputValue:u,onInputValueChange:d,fieldRef:a,inputRef:n,chips:T,setChips:M,validateWith:o,isLoading:c,suggestions:i,placeholder:h,openMenuOnFocus:g,listboxIsOpen:B,setListboxIsOpen:U,allowCustomValue:$,children:l})]})})}function La({items:e,setItems:s,displayChipUsing:a,chipSize:n,onChipClick:r}){const o=oe(),l=m.useCallback(i=>{const c=e.findIndex(d=>d.id===i),u=[...e];return c>-1&&(u.splice(c,1),s(u)),u},[e,s]);return t.jsx(Qs,{className:"my-8 max-w-full flex-shrink-0 flex-wrap",size:n,selectable:!0,children:e.map(i=>t.jsx(ws,{errorMessage:i.errorMessage,adornment:i.image?t.jsx(we,{circle:!0,src:i.image}):null,onClick:()=>r==null?void 0:r(i),onRemove:()=>{l(i.id).length?o==null||o.focusPrevious({tabbable:!0}):o==null||o.focusLast()},children:a(i)},i.id))})}function Ea(e){const{inputRef:s,fieldRef:a,validateWith:n,setChips:r,chips:o,suggestions:l,inputProps:i,placeholder:c,openMenuOnFocus:u,listboxIsOpen:d,setListboxIsOpen:f,allowCustomValue:h,isLoading:x}=e,j="outline-none text-sm mx-8 my-4 h-30 flex-auto",g=oe(),I=m.useCallback(y=>{y=(y||[]).filter(D=>{const z=!D||!D.id||!D.name;return!(o.findIndex(de=>de.id===(D==null?void 0:D.id))>-1)&&!z}),y.length&&(n&&(y=y.map(D=>n(D))),r([...o,...y]))},[o,r,n]),N=ks({...e,clearInputOnItemSelection:!0,isOpen:d,onOpenChange:f,items:l,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:y=>{M(y)}}),{state:{activeIndex:R,setActiveIndex:C,isOpen:w,setIsOpen:F,inputValue:$,setInputValue:p},refs:P,listboxId:S,collection:V,onInputChange:T}=N,M=y=>{const D=V.size&&R!=null?[...V.values()][R]:null;D!=null&&D.item?I([D.item]):h&&I([qe(D?D.value:y)]),p(""),C(null),F(!1)};mt(()=>{a.current&&P.reference.current!==a.current&&N.reference(a.current)},[a,N,P]);const{handleTriggerKeyDown:B,handleListboxKeyboardNavigation:U}=Ns(N),X=Is(()=>{u&&!w&&F(!0)});return t.jsx(Cs,{listbox:N,mobileOverlay:Ss,isLoading:x,onPointerDown:y=>{y.preventDefault()},children:t.jsx("input",{type:"text",className:v(j,"bg-transparent"),placeholder:c,...ne(i,{ref:s,value:$,onChange:T,onPaste:y=>{const z=y.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(z){y.preventDefault();const H=window.getSelection();H!=null&&H.rangeCount&&(H.deleteFromDocument(),I(z.map(de=>qe(de))))}},"aria-autocomplete":"list","aria-controls":w?S:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:y=>{const D=y.target;if(y.key==="Enter"){y.preventDefault(),M(D.value);return}if(y.key==="Escape"&&w&&(F(!1),p("")),y.key==="ArrowUp"&&w&&(R===0||R==null)){C(null);return}if(R!=null&&(y.key==="ArrowLeft"||y.key==="ArrowRight")){y.preventDefault();return}if((y.key==="ArrowLeft"||y.key==="Backspace"||y.key==="Delete")&&D.selectionStart===0&&R==null&&o.length){g==null||g.focusPrevious({tabbable:!0});return}B(y)||U(y)},onFocus:X,onClick:X})})})}function Ma({onChange:e,value:s,defaultValue:a,valueKey:n}){const r=m.useMemo(()=>lt(s),[s]),o=m.useMemo(()=>lt(a),[a]),l=m.useCallback(i=>{const c=n?i.map(u=>u[n]):i;e==null||e(c)},[e,n]);return re(r||void 0,o||[],l)}function lt(e){if(e!=null)return e.map(s=>typeof s!="object"?qe(s):s)}const Oa=O.forwardRef(Ta);function Ha({children:e,...s}){const{field:{onChange:a,onBlur:n,value:r=[],ref:o},fieldState:{invalid:l,error:i}}=je({name:s.name}),c={onChange:a,onBlur:n,value:r,invalid:l,errorMessage:i==null?void 0:i.message};return t.jsx(Oa,{ref:o,...ne(c,s),children:e})}function Ut({filter:e}){const{trans:s}=G();return t.jsx(Ha,{size:"sm",name:`${e.key}.value`,valueKey:"id",allowCustomValue:!1,showDropdownArrow:!0,placeholder:e.control.placeholder?s(e.control.placeholder):void 0,displayWith:a=>{var n;return(n=e.control.options.find(r=>r.key===a.id))==null?void 0:n.label.message},suggestions:e.control.options.map(a=>({id:a.key,name:a.label.message})),children:a=>t.jsx(Ie,{value:a.id,children:t.jsx(b,{message:a.name})},a.id)})}const Ba=m.memo(({value:e,...s})=>{const a=Ps(s);return isNaN(e)&&(e=0),t.jsx(m.Fragment,{children:a.format(e)})},yt);function qa(e){switch(e.filter.control.type){case L.DateRangePicker:return t.jsx(Ka,{...e});case L.BooleanToggle:return t.jsx(_a,{...e});case L.Select:return t.jsx(Ua,{...e});case L.ChipField:return t.jsx(Wa,{...e});case L.Input:return t.jsx(Za,{...e});case L.SelectModel:return t.jsx(Ga,{...e});case L.Custom:const s=e.filter.control.listItem;return t.jsx(s,{...e});default:return null}}function Ka(e){const{value:s,filter:a}=e;let n;return s.preset!==void 0?n=t.jsx(b,{...Xe[s.preset].label}):n=t.jsx(Mt,{start:new Date(s.start),end:new Date(s.end),options:{dateStyle:"medium"}}),t.jsx(ke,{...e,label:n,panel:t.jsx(qt,{filter:a})})}function _a({filter:e,isInactive:s,onValueChange:a}){return t.jsx(Pt,{onClick:()=>{a({value:e.control.defaultValue})},filter:e,isInactive:s})}function Ua(e){const{filter:s,value:a}=e,n=s.control.options.find(r=>r.key===a);return t.jsx(ke,{...e,label:n?t.jsx(b,{...n.label}):null,panel:t.jsx(Rt,{filter:s})})}function Wa(e){return t.jsx(ke,{...e,label:t.jsx(Qa,{...e}),panel:t.jsx(Ut,{filter:e.filter})})}function Qa(e){const{trans:s}=G(),{filter:a,value:n}=e,r=n.map(c=>a.control.options.find(u=>u.key===c)),o=3,l=n.length-o,i=t.jsx(m.Fragment,{children:r.filter(Boolean).slice(0,o).map((c,u)=>{let d="";return u!==0&&(d+=", "),d+=s(c.label),d})});return l>0?t.jsx(b,{message:":names + :count more",values:{names:i,count:l}}):i}function Za(e){const{filter:s,value:a,operator:n}=e,r=n?t.jsx(b,{...Kt[n]}):null,o=s.control.inputType==="number"?t.jsx(Ba,{value:a}):a;return t.jsx(ke,{...e,label:t.jsxs(m.Fragment,{children:[r," ",o]}),panel:t.jsx(_t,{filter:s})})}function Ga(e){const{value:s,filter:a}=e,{isLoading:n,data:r}=$t(`normalized-models/${a.control.model}/${s}`,void 0,{enabled:!!s}),o=t.jsxs(m.Fragment,{children:[t.jsx(W,{variant:"avatar",size:"w-18 h-18 mr-6"}),t.jsx(W,{variant:"rect",size:"w-50"})]}),l=t.jsxs(m.Fragment,{children:[t.jsx(we,{size:"xs",src:r==null?void 0:r.model.image,className:"mr-6"}),r==null?void 0:r.model.name]}),i=n||!r?o:l;return t.jsx(ke,{...e,label:i,panel:t.jsx(Ft,{filter:a})})}function Ja({filters:e,pinnedFilters:s,className:a}){const{decodedFilters:n,remove:r,replaceAll:o}=ze(e,s);return n.length?t.jsx("div",{className:v("flex items-center gap-6 overflow-x-auto",a),children:n.map((l,i)=>{const c=e.find(d=>d.key===l.key);if(!c)return null;const u=d=>{const f=[...n];f.splice(i,1,{key:c.key,value:d.value,isInactive:!1,operator:d.operator||c.defaultOperator}),o(f)};return t.jsxs("div",{children:[!l.isInactive&&t.jsx(Z,{variant:"outline",color:"primary",size:"xs",radius:"rounded-l-md",onClick:()=>{r(l.key)},children:t.jsx(Qe,{})}),t.jsx(qa,{filter:c,isInactive:l.isInactive,value:l.valueKey!=null?l.valueKey:l.value,operator:l.operator,onValueChange:u})]},l.key)})}):null}const Ya=se(t.jsx("path",{d:"M7 6h10l-5.01 6.3L7 6zm-2.75-.39C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAltOutlined"),Xa=O.forwardRef(({variant:e="default",mode:s="single",children:a,className:n,isLazy:r,...o},l)=>{const[i,c]=re(o.expandedValues,o.defaultExpandedValues||[],o.onExpandedChange),u=O.Children.count(a);return t.jsx("div",{className:v(e==="outline"&&"space-y-10",n),ref:l,role:"presentation",children:t.jsx(me,{children:t.jsx(Ke,{children:O.Children.map(a,(d,f)=>m.isValidElement(d)?m.cloneElement(d,{key:d.key||f,value:d.props.value||f,isFirst:f===0,isLast:f===u-1,mode:s,variant:e,expandedValues:i,setExpandedValues:c,isLazy:r}):null)})})})});function en({children:e,label:s,disabled:a,bodyClassName:n,labelClassName:r,buttonPadding:o="py-10 pl-14 pr-10",startIcon:l,description:i,endAppend:c,chevronPosition:u="right",isFirst:d,isLast:f,...h}){const{expandedValues:x,setExpandedValues:j,variant:g,value:I,mode:N,isLazy:R}=h,C=m.useRef(null),w=!a&&x.includes(I),F=m.useRef(!1);w&&(F.current=!0);const $=oe(),p=m.useId(),P=`${p}-button`,S=`${p}-panel`,V=B=>{switch(B.key){case"ArrowDown":$==null||$.focusNext();break;case"ArrowUp":$==null||$.focusPrevious();break;case"Home":$==null||$.focusFirst();break;case"End":$==null||$.focusLast();break}},T=()=>{const B=x.indexOf(I);if(B>-1){const U=[...x];U.splice(B,1),j(U)}else j(N==="single"?[I]:[...x,I])},M=t.jsx("div",{className:v(g==="minimal"&&""),children:t.jsx(Rs,{"aria-hidden":"true",size:"md",className:v(a?"text-disabled":"text-muted",w&&"rotate-180 transition-transform")})});return t.jsxs("div",{className:v(g==="default"&&"border-b",g==="outline"&&"rounded-panel border",a&&"text-disabled"),children:[t.jsxs("h3",{className:v("flex w-full items-center justify-between text-sm",a&&"pointer-events-none",d&&g==="default"&&"border-t",w&&g!=="minimal"?"border-b":"border-b border-b-transparent",g==="outline"?w?"rounded-panel-t":"rounded-panel":void 0),children:[t.jsxs("button",{disabled:a,"aria-expanded":w,id:P,"aria-controls":S,type:"button",ref:C,onKeyDown:V,onClick:()=>{a||T()},className:v("flex flex-auto items-center gap-10 text-left outline-none hover:bg-hover focus-visible:bg-primary/focus",o),children:[u==="left"&&M,l&&m.cloneElement(l,{size:"md",className:v(l.props.className,a?"text-disabled":"text-muted")}),t.jsxs("div",{className:"flex-auto overflow-hidden overflow-ellipsis",children:[t.jsx("div",{className:r,"data-testid":"accordion-label",children:s}),i&&t.jsx("div",{className:"text-xs text-muted",children:i})]}),u==="right"&&M]}),c&&t.jsx("div",{className:"flex-shrink-0 px-4 text-sm text-muted",children:c})]}),t.jsx(ae.div,{"aria-labelledby":p,role:"region",variants:st.variants,transition:st.transition,initial:!1,animate:w?"open":"closed",children:t.jsx("div",{className:v("p-16",n),children:!R||F?e:null})})]})}function tn({filter:e}){return null}function sn({filters:e}){const{decodedFilters:s}=ze(e),{formId:a}=_(),[n,r]=m.useState(()=>s.map(i=>i.key)),o=t.jsx(E,{size:"xs",variant:"outline",className:"mr-auto",onClick:()=>{r([])},children:t.jsx(b,{message:"Clear"})}),l=t.jsx(E,{size:"xs",variant:"flat",color:"primary",className:"ml-auto",type:"submit",form:a,children:t.jsx(b,{message:"Apply"})});return t.jsxs(J,{className:"min-w-[300px]",maxWidth:"max-w-400",size:"auto",children:[t.jsx(le,{padding:"px-14 py-10",leftAdornment:o,rightAdornment:l,children:t.jsx(b,{message:"Filter"})}),t.jsx(Y,{padding:"p-0",children:t.jsx(an,{filters:e,expandedFilters:n,setExpandedFilters:r})})]})}function an({filters:e,expandedFilters:s,setExpandedFilters:a}){const{decodedFilters:n,replaceAll:r}=ze(e),o={};e.forEach(u=>{const d=n.find(f=>f.key===u.key);o[u.key]=(d==null?void 0:d.value)!==void 0?d:{value:u.control.defaultValue,operator:u.defaultOperator}});const l=ge({defaultValues:o}),{formId:i,close:c}=_();return t.jsx(Pe,{form:l,id:i,onSubmit:u=>{const d=Object.entries(u).filter(([f,h])=>s.includes(f)&&h!==void 0).map(([f,h])=>({key:f,...h}));r(d),c()},children:t.jsx(Xa,{mode:"multiple",expandedValues:s,onExpandedChange:a,children:e.map(u=>t.jsxs(en,{startIcon:t.jsx($s,{checked:s.includes(u.key)}),value:u.key,label:t.jsx(b,{...u.label}),bodyClassName:"max-h-288 overflow-y-auto compact-scrollbar",children:[u.description&&t.jsx("div",{className:v("text-xs text-muted",u.control.type!==L.BooleanToggle&&"mb-14"),children:t.jsx(b,{...u.description})}),t.jsx(nn,{filter:u})]},u.key))})})}function nn({filter:e}){switch(e.control.type){case L.Select:return t.jsx(Rt,{filter:e});case L.ChipField:return t.jsx(Ut,{filter:e});case L.DateRangePicker:return t.jsx(qt,{filter:e});case L.SelectModel:return t.jsx(Ft,{filter:e});case L.Input:return t.jsx(_t,{filter:e});case L.BooleanToggle:return t.jsx(tn,{filter:e});case"custom":const s=e.control.panel;return t.jsx(s,{filter:e});default:return null}}function rn({filters:e,icon:s=t.jsx(Ya,{}),color:a="primary",variant:n="outline",size:r="sm",disabled:o,className:l}){const i=ce(),c=t.jsx(E,{variant:n,color:a,startIcon:s,disabled:o,size:r,className:l,children:t.jsx(b,{message:"Filter"})}),u=t.jsx(Z,{color:a,size:"sm",variant:n,disabled:o,className:l,children:s});return t.jsxs(Q,{type:"popover",children:[i?u:c,t.jsx(sn,{filters:e})]})}function Wt(e){var s;return{...e,defaultOperator:Ne.between,control:{type:L.DateRangePicker,defaultValue:((s=e.control)==null?void 0:s.defaultValue)||Bt(Xe[3].getRangeValue())}}}function on(e){return Wt({key:"created_at",label:k("Date created"),...e})}function ln(e){return Wt({key:"updated_at",label:k("Last updated"),...e})}const cn="user";function Qt({image:e,label:s,description:a,labelClassName:n,avatarSize:r="md"}){return t.jsxs("div",{className:"flex items-center gap-12",children:[e&&t.jsx(we,{size:r,className:"flex-shrink-0",src:e}),t.jsxs("div",{className:"min-w-0 overflow-hidden",children:[t.jsx("div",{className:v(n,"overflow-hidden overflow-ellipsis"),children:s}),a&&t.jsx("div",{className:"overflow-hidden overflow-ellipsis text-xs text-muted",children:a})]})]})}const nr=se(t.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVertOutlined");function rr({children:e,color:s,variant:a,radius:n="rounded-button",size:r,className:o,value:l,onChange:i,multiple:c,disabled:u}){const d=x=>l===void 0?!1:c?l.includes(x):x===l,f=x=>{const j=[...l],g=l.indexOf(x);return g>-1?j.splice(g,1):j.push(x),j},h=O.Children.map(e,(x,j)=>{if(O.isValidElement(x)){const g=d(x.props.value),I=g?"primary":s;return O.cloneElement(x,{color:g?"primary":s,variant:a,size:r,radius:null,disabled:x.props.disabled||u,...x.props,onClick:N=>{x.props.onClick&&x.props.onClick(N),i&&(c?i==null||i(f(x.props.value)):i==null||i(x.props.value))},className:v(x.props.className,g?"z-20":"z-10",dn(j,e,n,I))})}});return t.jsx("div",{className:v(n,"isolate inline-flex",o),children:h})}function dn(e,s,a,n){return e===0?v(a,"rounded-tr-none rounded-br-none",!n&&"border-r-transparent disabled:border-r-transparent"):e===s.length-1?v(a,"rounded-tl-none rounded-bl-none -ml-1"):v("rounded-none -ml-1",!n&&"border-r-transparent disabled:border-r-transparent")}function un(e){return ye({mutationFn:s=>mn(s),onSuccess:async()=>{await ve.invalidateQueries({queryKey:["canned-replies"]}),Ve(k("Saved reply created"))},onError:s=>Ze(s,e)})}function mn(e){return K.post("canned-replies",e).then(s=>s.data)}function Zt({onSubmit:e,form:s,reply:a}){var u;const{formId:n}=_(),r=m.useRef(null),[o,l]=m.useState((a==null?void 0:a.attachments)||[]),i=(u=s.formState.errors.body)==null?void 0:u.message,c=()=>{e({...s.getValues(),body:Ws(r),attachments:o.map(d=>d.id)})};return t.jsx(Pe,{id:n,form:s,onSubmit:c,onBeforeSubmit:()=>s.clearErrors(),children:t.jsx(m.Fragment,{children:t.jsxs(Fs,{children:[t.jsx(We,{autoFocus:!0,className:"mb-24",label:t.jsx(b,{message:"Name"}),name:"name"}),t.jsx(Ht,{className:"mb-24",name:"shared",description:t.jsx(b,{message:"Shared replies will be visible to all agents, not just you."}),children:t.jsx(b,{message:"Shared"})}),t.jsx(Us,{initialContent:(a==null?void 0:a.body)||"",minHeight:"min-h-[300px]",isLoading:!1,editorRef:r,attachments:o,onAttachmentsChange:d=>l(d),onSubmit:c}),i&&t.jsx("div",{className:"pt-10 text-xs text-danger",children:i})]})})})}function fn(){const{close:e,formId:s}=_(),a=ge({defaultValues:{shared:!1}}),n=un(a),r=o=>{n.mutate(o,{onSuccess:()=>e()})};return t.jsxs(J,{size:"lg",children:[t.jsx(le,{children:t.jsx(b,{message:"New saved reply"})}),t.jsx(Y,{children:t.jsx(Zt,{form:a,onSubmit:r})}),t.jsxs(ie,{children:[t.jsx(E,{onClick:()=>e(),children:t.jsx(b,{message:"Cancel"})}),t.jsx(E,{type:"submit",form:s,variant:"flat",color:"primary",disabled:n.isPending,children:t.jsx(b,{message:"Save"})})]})]})}const Gt=(e,s)=>{const a=e.split("/");return s&&a.push(s),a};function xn(e,s,a,n){return be({queryKey:Gt(e,s),queryFn:({signal:r})=>hn(e,s,n,r),placeholderData:ht,...a})}async function hn(e,s,a,n){s.query&&await new Promise(o=>setTimeout(o,300));const r=await K.get(e,{params:s,signal:s.query?n:void 0}).then(o=>o.data);return a==null||a(r),r}const Jt=O.createContext(null);function Yt(){return m.useContext(Jt)}function pn({actions:e,filters:s,filtersLoading:a,searchPlaceholder:n=k("Type to search..."),searchValue:r="",onSearchChange:o}){const{trans:l}=G();return t.jsxs(Xt,{children:[t.jsx(Vs,{inputTestId:"datatable-search",className:"flex-auto max-w-440 mr-auto",inputWrapperClassName:"mr-24 md:mr-0",placeholder:l(n),startAdornment:t.jsx(zs,{}),value:r,onChange:i=>{o(i.target.value)}}),s&&t.jsx(rn,{filters:s,disabled:a}),e]})}function Xt({children:e,...s}){return t.jsx("div",{className:"mb-24 flex items-center gap-8 md:gap-12 text-muted relative h-42",...s,children:e})}function bn({actions:e,selectedItemsCount:s}){return t.jsxs(Xt,{"data-testid":"datatable-selected-header",children:[t.jsx("div",{className:"mr-auto",children:t.jsx(b,{message:"[one 1 item|other :count items] selected",values:{count:s}})}),e]})}function gn(){return t.jsxs(ae.div,{className:"flex items-center gap-6 h-30",...$e,children:[t.jsx(W,{variant:"rect",size:"h-full w-144",radius:"rounded-md"}),t.jsx(W,{variant:"rect",size:"h-full w-112",radius:"rounded-md"}),t.jsx(W,{variant:"rect",size:"h-full w-172",radius:"rounded-md"})]},"filter-list-skeleton")}function jn({filters:e,filtersLoading:s,columns:a,searchPlaceholder:n,queryParams:r,endpoint:o,actions:l,selectedActions:i,emptyStateMessage:c,tableDomProps:u,onRowAction:d,enableSelection:f=!0,selectionStyle:h="checkbox",children:x,cellHeight:j,collapseTableOnMobile:g=!0}){var V;const I=ce(),{trans:N}=G(),{encodedFilters:R}=ze(e),[C,w]=m.useState({perPage:15}),[F,$]=m.useState([]),p=xn(o,{...C,...r,[Ce]:R},void 0,()=>$([])),P=!!(C.query||C.filters||R),S=(V=p.data)==null?void 0:V.pagination;return t.jsxs(Jt.Provider,{value:{selectedRows:F,setSelectedRows:$,endpoint:o,params:C,setParams:w,query:p},children:[x,t.jsx(me,{initial:!1,mode:"wait",children:F.length?t.jsx(bn,{selectedItemsCount:F.length,actions:i},"selected"):t.jsx(pn,{searchPlaceholder:n,searchValue:C.query,onSearchChange:T=>w({...C,query:T}),actions:l,filters:e,filtersLoading:s},"default")}),e&&t.jsx("div",{className:"mb-14",children:t.jsx(me,{initial:!1,mode:"wait",children:s&&R?t.jsx(gn,{}):t.jsx(ae.div,{...$e,children:t.jsx(Ja,{filters:e})},"filter-list")})}),t.jsxs("div",{className:v("relative rounded-panel",(!I||!g)&&"border"),children:[p.isFetching&&t.jsx(ut,{isIndeterminate:!0,className:"absolute left-0 top-0 z-10 w-full","aria-label":N({message:"Loading"}),size:"xs"}),t.jsx("div",{className:"relative overflow-x-auto md:overflow-hidden",children:t.jsx(kt,{...u,columns:a,data:(S==null?void 0:S.data)||[],sortDescriptor:C,onSortChange:T=>{w({...C,...T})},selectedRows:F,enableSelection:f,selectionStyle:h,onSelectionChange:$,onAction:d,collapseOnMobile:g,cellHeight:j})}),(p.isFetched||p.isPlaceholderData)&&!(S!=null&&S.data.length)?t.jsx("div",{className:"pt-50",children:m.cloneElement(c,{isFiltering:P})}):void 0,t.jsx(Ct,{query:p,onPageChange:T=>w({...C,page:T}),onPerPageChange:T=>w({...C,perPage:T})})]})]})}function yn({title:e,headerContent:s,headerItemsAlign:a="items-end",className:n,...r}){const o=m.useId();return t.jsxs("div",{className:v("p-12 md:p-24",n),children:[e&&t.jsxs("div",{className:v("mb-16",s&&`flex ${a} gap-4`),children:[t.jsx(As,{children:e}),t.jsx("h1",{className:"text-3xl font-light first:capitalize",id:o,children:e}),s]}),t.jsx(jn,{...r,tableDomProps:{"aria-labelledby":e?o:void 0}})]})}const it=se(t.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"AddOutlined"),vn=O.forwardRef(({children:e,to:s,elementType:a,onClick:n},r)=>ce()?t.jsx(Z,{ref:r,variant:"flat",color:"primary",className:"flex-shrink-0",size:"sm",to:s,elementType:a,onClick:n,children:t.jsx(it,{})}):t.jsx(E,{ref:r,startIcon:t.jsx(it,{}),variant:"flat",color:"primary",size:"sm",to:s,elementType:a,onClick:n,children:e}));function wn(){const{endpoint:e,selectedRows:s,setSelectedRows:a}=Yt();return ye({mutationFn:()=>kn(e,s),onSuccess:async()=>{await ve.invalidateQueries({queryKey:Gt(e)}),Ve(k("Deleted [one 1 record|other :count records]",{values:{count:s.length}})),a([])},onError:n=>St(n,k("Could not delete records"))})}function kn(e,s){return K.delete(`${e}/${s.join(",")}`).then(a=>a.data)}function Cn(){return t.jsxs(Q,{type:"modal",children:[t.jsx(E,{variant:"flat",color:"danger",className:"ml-auto",children:t.jsx(b,{message:"Delete"})}),t.jsx(Sn,{})]})}function Sn(){const e=wn(),{selectedRows:s}=Yt(),{close:a}=_();return t.jsx(Dt,{isLoading:e.isPending,title:t.jsx(b,{message:"Delete [one 1 item|other :count items]?",values:{count:s.length}}),body:t.jsx(b,{message:"This will permanently remove the items and cannot be undone."}),confirm:t.jsx(b,{message:"Delete"}),isDanger:!0,onConfirm:()=>{e.mutate(void 0,{onSuccess:()=>a()})}})}const Dn=""+new URL("online-articles-1ec8936a.svg",import.meta.url).href,Nn=[{key:"shared",label:k("Shared"),description:k("Whether reply is marked as shared"),defaultOperator:Ne.eq,control:{type:L.BooleanToggle,defaultValue:!0}},{key:"user_id",label:k("Owner"),description:k("User this reply was created by"),defaultOperator:Ne.eq,control:{type:L.SelectModel,model:cn}},on({description:k("Date reply was created")}),ln({description:k("Date reply was last updated")})];function In(){return ye({mutationFn:e=>Pn(e),onSuccess:async()=>{await ve.invalidateQueries({queryKey:["canned-replies"]})},onError:e=>St(e)})}function Pn(e){return K.delete(`canned-replies/${e.ids.join(",")}`).then(s=>s.data)}function Rn(e,s){return ye({mutationFn:a=>$n(s,a),onSuccess:async()=>{await ve.invalidateQueries({queryKey:["canned-replies"]}),Ve(k("Reply updated"))},onError:a=>Ze(a,e)})}function $n(e,s){return K.put(`canned-replies/${e}`,s).then(a=>a.data)}function Fn({reply:e}){var l;const{close:s,formId:a}=_(),n=ge({defaultValues:{name:e.name,body:e.body,shared:e.shared,attachments:(l=e.attachments)==null?void 0:l.map(i=>i.id)}}),r=Rn(n,e.id),o=i=>{r.mutate(i,{onSuccess:()=>s()})};return t.jsxs(J,{size:"lg",children:[t.jsx(le,{children:t.jsx(b,{message:"Update saved reply"})}),t.jsx(Y,{children:t.jsx(Zt,{form:n,onSubmit:o,reply:e})}),t.jsxs(ie,{children:[t.jsx(E,{onClick:()=>s(),children:t.jsx(b,{message:"Cancel"})}),t.jsx(E,{type:"submit",form:a,variant:"flat",color:"primary",disabled:r.isPending,children:t.jsx(b,{message:"Save"})})]})]})}function Vn(e,s,a="..."){return s==null||s>=e.length?e:e.slice(0,Math.max(0,s-a.length))+a}function zn(e){return e.replace(/<\/?[^>]+(>|$)/g,"")}const An=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>t.jsx(b,{message:"Saved reply"}),body:e=>t.jsx(Tn,{reply:e})},{key:"user_id",allowsSorting:!0,width:"min-w-200",visibleInMode:"all",header:()=>t.jsx(b,{message:"Owner"}),body:e=>e.user?t.jsx(Qt,{image:e.user.avatar,label:e.user.display_name,description:e.user.email}):null},{key:"shared",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>t.jsx(b,{message:"Shared"}),body:e=>e.shared?t.jsx(Nt,{size:"md",className:"text-positive"}):t.jsx(Qe,{size:"md",className:"text-danger"})},{key:"updatedAt",allowsSorting:!0,width:"w-96",header:()=>t.jsx(b,{message:"Last updated"}),body:e=>t.jsx("time",{children:t.jsx(Ts,{date:e.updated_at})})},{key:"actions",header:()=>t.jsx(b,{message:"Actions"}),width:"w-84 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:e=>t.jsxs("div",{className:"text-muted",children:[t.jsxs(Q,{type:"modal",children:[t.jsx(Oe,{label:t.jsx(b,{message:"Edit reply"}),children:t.jsx(Z,{size:"md",children:t.jsx(It,{})})}),t.jsx(Fn,{reply:e})]}),t.jsxs(Q,{type:"modal",children:[t.jsx(Oe,{label:t.jsx(b,{message:"Delete reply"}),children:t.jsx(Z,{children:t.jsx(Js,{})})}),t.jsx(Ln,{reply:e})]})]})}];function Tn({reply:e}){const{isCollapsedMode:s}=m.useContext(Ls);return t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:v(s?"whitespace-normal":"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium"),children:e.name}),!s&&t.jsx("p",{className:"mt-4 max-w-680 whitespace-normal text-xs text-muted",children:Vn(zn(e.body),230)})]})}function Ln({reply:e}){const s=In(),{close:a}=_();return t.jsx(Dt,{isDanger:!0,isLoading:s.isPending,title:t.jsx(b,{message:"Delete saved reply"}),body:t.jsx(b,{message:"Are you sure you want to delete this saved reply?"}),confirm:t.jsx(b,{message:"Delete"}),onConfirm:()=>{s.mutate({ids:[e.id]},{onSuccess:()=>a()})}})}function or({userId:e}){const{columns:s,filters:a}=m.useMemo(()=>({columns:An.filter(n=>n.key!=="user_id"||!e),filters:Nn.filter(n=>n.key!=="user_id"||!e)}),[e]);return t.jsx(yn,{endpoint:"canned-replies",title:t.jsx(b,{message:"Saved replies"}),columns:s,filters:a,queryParams:{shared:"true",with:e?void 0:"user",user_id:e},actions:t.jsx(En,{}),selectedActions:t.jsx(Cn,{}),enableSelection:!1,cellHeight:"h-76",emptyStateMessage:t.jsx(Es,{image:Dn,title:t.jsx(b,{message:"No saved replies have been created yet"}),filteringTitle:t.jsx(b,{message:"No matching replies"})})})}function En(){return t.jsxs(Q,{type:"modal",children:[t.jsx(vn,{children:t.jsx(b,{message:"Add reply"})}),t.jsx(fn,{})]})}const Mn=se(t.jsx("path",{d:"M9 8a1 1 0 0 0-1-1H5.5a1 1 0 1 0 0 2H7v4a1 1 0 0 0 2 0zM4 0h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4zm4 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}),"InfoDialogTrigger");function On({title:e,body:s,dialogSize:a="sm",className:n}){return t.jsxs(Q,{type:"popover",triggerOnHover:!0,children:[t.jsx(Z,{className:v("text-muted opacity-70",n),size:"xs",children:t.jsx(Mn,{viewBox:"0 0 16 16"})}),t.jsxs(J,{size:a,children:[e&&t.jsx(le,{padding:"px-18 pt-12",size:"md",hideDismissButton:!0,children:e}),t.jsx(Y,{children:s})]})]})}function Hn(e,s){return ye({mutationFn:a=>Bn(s,a),onSuccess:async()=>{Ve(k("User suspended")),await ve.invalidateQueries({queryKey:["users"]})},onError:a=>Ze(a,e)})}function Bn(e,s){return K.post(`users/${e}/ban`,s).then(a=>a.data)}function qn(e){const s=Ge(),[a,n]=m.useState(!e.value&&!e.defaultValue),r=e.onChange,[o,l]=re(e.value||s,e.defaultValue||s,w=>{n(!1),r==null||r(w)}),{min:i,max:c,granularity:u,timezone:d,calendarIsOpen:f,setCalendarIsOpen:h,closeDialogOnSelection:x}=At(o,e),j=m.useCallback(()=>{n(!0),l(s),r==null||r(null),h(!1)},[s,l,r,h]),[g,I]=m.useState(()=>[fe(o)]),N=m.useCallback(w=>{i&&w.compare(i)<0?w=i:c&&w.compare(c)>0&&(w=c);const F=o?o.set(w):ee(w,d);l(F),I([fe(F)]),n(!1)},[l,i,c,o,d]),R=m.useCallback(w=>!a&&ue(o,w),[o,a]),C=m.useCallback(w=>({onClick:()=>{N==null||N(w),x&&(h==null||h(!1))}}),[N,h,x]);return{selectedValue:o,setSelectedValue:l,calendarIsOpen:f,setCalendarIsOpen:h,dayIsActive:R,dayIsHighlighted:()=>!1,dayIsRangeStart:()=>!1,dayIsRangeEnd:()=>!1,getCellProps:C,calendarDates:g,setCalendarDates:I,isPlaceholder:a,clear:j,setIsPlaceholder:n,min:i,max:c,granularity:u,timezone:d,closeDialogOnSelection:x}}function Kn({showCalendarFooter:e,...s}){const a=qn(s),n=m.useRef(null),r=Ge(),o=e&&t.jsx(ie,{padding:"px-14 pb-14",startAction:t.jsx(E,{disabled:a.isPlaceholder,variant:"text",color:"primary",onClick:()=>{a.clear()},children:t.jsx(b,{message:"Clear"})}),children:t.jsx(E,{variant:"text",color:"primary",onClick:()=>{a.setSelectedValue(r),a.setCalendarIsOpen(!1)},children:t.jsx(b,{message:"Today"})})}),l=t.jsx(Q,{offset:8,placement:"bottom-start",isOpen:a.calendarIsOpen,onOpenChange:a.setCalendarIsOpen,type:"popover",triggerRef:n,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:t.jsxs(J,{size:"auto",children:[t.jsx(Y,{className:"flex items-start gap-40",padding:e?"px-24 pt-20 pb-10":null,children:t.jsx(Et,{state:a,visibleMonths:1})}),o]})}),i={onClick:c=>{c.stopPropagation(),c.preventDefault(),Un(c)?a.setCalendarIsOpen(!1):a.setCalendarIsOpen(!0)}};return t.jsxs(m.Fragment,{children:[t.jsx(Ye,{ref:n,wrapperProps:i,endAdornment:t.jsx(Vt,{className:v(s.disabled&&"text-disabled")}),...s,children:t.jsx(pe,{segmentProps:i,state:a,value:a.selectedValue,onChange:a.setSelectedValue,isPlaceholder:a.isPlaceholder})}),l]})}function _n(e){const{min:s,max:a}=e,{trans:n}=G(),{format:r}=te(),{field:{onChange:o,onBlur:l,value:i=null,ref:c},fieldState:{invalid:u,error:d}}=je({name:e.name,rules:{validate:x=>{if(!x)return;const j=De(x);if(s&&j.compare(s)<0)return n({message:"Enter a date after :date",values:{date:r(x)}});if(a&&j.compare(a)>0)return n({message:"Enter a date before :date",values:{date:r(x)}})}}}),f=i?De(i):null,h={onChange:x=>{o(x&&x.toAbsoluteString())},onBlur:l,value:f,invalid:u,errorMessage:d==null?void 0:d.message,inputRef:c};return t.jsx(Kn,{...ne(h,e)})}function Un(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}function lr({user:e}){const{trans:s}=G(),{close:a,formId:n}=_(),r=ge({defaultValues:{permanent:!0}}),o=r.watch("permanent"),l=Hn(r,e.id);return t.jsxs(J,{children:[t.jsx(le,{children:t.jsx(b,{message:"Suspend “:name“",values:{name:e.display_name}})}),t.jsx(Y,{children:t.jsxs(Pe,{id:n,form:r,onSubmit:i=>l.mutate(i,{onSuccess:()=>a()}),children:[t.jsx(_n,{name:"ban_until",label:t.jsx(b,{message:"Suspend until"}),disabled:o}),t.jsx(Ht,{name:"permanent",className:"mt-12",children:t.jsx(b,{message:"Permanent"})}),t.jsx(We,{className:"mt-24",name:"comment",inputElementType:"textarea",maxLength:250,label:t.jsx(b,{message:"Reason"}),placeholder:s(k("Optional"))})]})}),t.jsxs(ie,{children:[t.jsx(E,{onClick:()=>a(),children:t.jsx(b,{message:"Cancel"})}),t.jsx(E,{form:n,variant:"flat",color:"primary",type:"submit",disabled:l.isPending,children:t.jsx(b,{message:"Suspend"})})]})]})}function Wn({skipCtr:e,description:s}){return[{key:"normalized_term",header:()=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{children:t.jsx(b,{message:"Term"})}),!!s&&t.jsx(On,{body:s})]}),visibleInMode:"all",body:n=>t.jsx(Ms,{to:`/hc/search/${n.term}`,className:Os,target:"_blank",children:n.term})},{key:"count",header:()=>t.jsx(b,{message:"Count"}),width:"w-144",body:n=>t.jsx("span",{children:n.count||1})},e?null:{key:"ctr",header:()=>t.jsx(b,{message:"CTR"}),width:"w-144",body:n=>t.jsxs("span",{children:[n.ctr,"%"]})},{key:"resulted_in_ticket",header:()=>t.jsx(b,{message:"Resulted in ticket"}),width:"w-144",body:n=>t.jsx("span",{className:"text-muted",children:n.resulted_in_ticket?t.jsx(Nt,{}):t.jsx(Qe,{})})},{key:"last_seen",header:()=>t.jsx(b,{message:"Last seen"}),visibleInMode:"all",width:"w-144",body:n=>t.jsx(Hs,{date:n.last_seen})},{key:"category",header:()=>t.jsx(b,{message:"Category"}),visibleInMode:"all",body:n=>n.category?t.jsx(Qt,{image:n.category.image,label:t.jsx(Bs,{category:n.category,target:"_blank"}),description:n.category.description}):null}].filter(Boolean)}function Qn(e){var a,n;const s={...e};return s.dateRange&&(s.startDate=s.dateRange.start.toAbsoluteString(),s.endDate=s.dateRange.end.toAbsoluteString(),s.compareStartDate=(a=s.dateRange.compareStart)==null?void 0:a.toAbsoluteString(),s.compareEndDate=(n=s.dateRange.compareEnd)==null?void 0:n.toAbsoluteString(),s.timezone=s.dateRange.start.timeZone,delete s.dateRange),s}function Zn(e){return be({queryKey:["reports","search",e],queryFn:()=>Gn(e)})}function Gn(e){return K.get("reports/search",{params:Qn(e)}).then(s=>s.data)}function ir({userId:e,dateRange:s,failedSearches:a,description:n}){const[r,o]=ft(),l=Zn({dateRange:s,userId:e,failedSearches:a,page:r.get("page")||1,perPage:r.get("perPage")||15}),{data:i,fetchStatus:c,isLoading:u,isPlaceholderData:d}=l,f=(i==null?void 0:i.pagination.data)||[],h=c==="idle"&&f.length===0||!u&&!d&&f.length===0,x=m.useMemo(()=>Wn({skipCtr:a,description:n}),[n,a]);return t.jsxs("div",{className:"relative max-md:overflow-x-auto",children:[t.jsx(Zs,{query:l}),t.jsx(kt,{columns:x,data:f,enableSelection:!1,collapseOnMobile:!1,className:"max-md:w-min"}),h&&t.jsx(qs,{className:"mt-48",image:t.jsx(Ks,{src:_s}),title:t.jsx(b,{message:"There are no searches to display"})}),t.jsx(Ct,{query:l,onPageChange:j=>o(g=>(g.set("page",j.toString()),g)),onPerPageChange:j=>o(g=>(g.set("perPage",j.toString()),g))})]})}export{rn as A,rr as B,Qs as C,Js as D,Yt as E,Ne as F,Zs as G,_n as H,On as I,Qn as J,Ba as K,Vt as L,nr as M,Qt as N,Mt as O,xa as P,Ia as Q,Ra as R,ir as S,tr as T,cn as U,Xe as V,Vn as W,zn as X,Dn as Y,Lt as Z,Ya as _,L as a,ln as b,on as c,Ja as d,ar as e,sr as f,ma as g,fn as h,or as i,Ha as j,it as k,lr as l,yn as m,Cn as n,vn as o,Ht as p,Xa as q,en as r,Ot as s,Wt as t,er as u,Oa as v,Je as w,Gt as x,oa as y,jn as z};
//# sourceMappingURL=search-report-table-f6cb928f.js.map
