{"version":3,"file":"hc-ticket-routes-909add96.js","sources":["../../../resources/client/help-center/tickets/customer-ticket-list-page/customer-ticket-table-columns.tsx","../../../resources/client/help-center/tickets/customer-ticket-list-page/customer-ticket-list-page.tsx","../../../resources/client/help-center/tickets/use-submit-customer-reply.ts","../../../resources/client/help-center/tickets/customer-ticket-page.tsx","../../../resources/client/help-center/tickets/customer-new-ticket-page/use-customer-ticket-categories.ts","../../../resources/client/help-center/tickets/customer-new-ticket-page/use-customer-new-ticket-config.ts","../../../resources/client/help-center/tickets/customer-new-ticket-page/suggested-articles-drawer.tsx","../../../resources/client/help-center/tickets/customer-new-ticket-page/customer-new-ticket-page.tsx","../../../resources/client/help-center/tickets/hc-ticket-routes.tsx"],"sourcesContent":["import {ColumnConfig} from '@common/datatable/column-config';\nimport {Ticket} from '@app/agent/ticket';\nimport {Trans} from '@common/i18n/trans';\nimport {FormattedRelativeTime} from '@common/i18n/formatted-relative-time';\nimport {Chip} from '@common/ui/forms/input-field/chip-field/chip';\nimport React from 'react';\n\nexport const CustomerTicketTableColumns: ColumnConfig<Ticket>[] = [\n  {\n    key: 'subject',\n    visibleInMode: 'all',\n    header: () => <Trans message=\"Subject\" />,\n    body: ticket => ticket.subject,\n    width: 'flex-3 min-w-200',\n  },\n  {\n    key: 'id',\n    allowsSorting: true,\n    header: () => <Trans message=\"Id\" />,\n    width: 'w-90',\n    body: ticket => `#${ticket.id}`,\n  },\n  {\n    key: 'Created',\n    allowsSorting: true,\n    header: () => <Trans message=\"Created\" />,\n    width: 'w-144',\n    body: ticket => <FormattedRelativeTime date={ticket.created_at} />,\n  },\n  {\n    key: 'updated_at',\n    allowsSorting: true,\n    header: () => <Trans message=\"Last updated\" />,\n    width: 'w-144',\n    body: ticket => <FormattedRelativeTime date={ticket.updated_at} />,\n  },\n  {\n    key: 'status',\n    header: () => <Trans message=\"Status\" />,\n    visibleInMode: 'all',\n    width: 'w-80',\n    body: ticket => (\n      <div className=\"w-max\">\n        <Chip\n          size=\"sm\"\n          color={!ticket.closed_at ? 'primary' : undefined}\n          radius=\"rounded-md\"\n          className=\"font-medium capitalize\"\n        >\n          <Trans message={ticket.status} />\n        </Chip>\n      </div>\n    ),\n  },\n];\n","import {HcSearchBar} from '@app/help-center/search/hc-search-bar';\nimport React, {Fragment, useRef} from 'react';\nimport {Navbar} from '@common/ui/navigation/navbar/navbar';\nimport {Trans} from '@common/i18n/trans';\nimport {useTickets} from '@app/agent/agent-ticket-page/user-details-sidebar/requests/use-tickets';\nimport {useAuth} from '@common/auth/use-auth';\nimport {Table} from '@common/ui/tables/table';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {TextField} from '@common/ui/forms/input-field/text-field/text-field';\nimport {useTrans} from '@common/i18n/use-trans';\nimport {message} from '@common/i18n/message';\nimport {SearchIcon} from '@common/icons/material/Search';\nimport {Link, useSearchParams} from 'react-router-dom';\nimport {Select} from '@common/ui/forms/select/select';\nimport {Item} from '@common/ui/forms/listbox/item';\nimport {DataTableEmptyStateMessage} from '@common/datatable/page/data-table-emty-state-message';\nimport searchImage from '@app/agent/agent-search-page/search.svg';\nimport {Skeleton} from '@common/ui/skeleton/skeleton';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '@common/ui/animation/opacity-animation';\nimport {DataTablePaginationFooter} from '@common/datatable/data-table-pagination-footer';\nimport {Button} from '@common/ui/buttons/button';\nimport {CustomerTicketTableColumns} from '@app/help-center/tickets/customer-ticket-list-page/customer-ticket-table-columns';\nimport {BreadcrumbItem} from '@common/ui/breadcrumbs/breadcrumb-item';\nimport {Breadcrumb} from '@common/ui/breadcrumbs/breadcrumb';\n\nconst defaultPage = '1';\nconst defaultPerPage = '20';\n\nexport function CustomerTicketListPage() {\n  const navigate = useNavigate();\n  return (\n    <div>\n      <Navbar menuPosition=\"header\">\n        <HcSearchBar />\n      </Navbar>\n      <main className=\"container mx-auto px-24 pb-48\">\n        <Breadcrumb size=\"sm\" className=\"mb-48 mt-34\">\n          <BreadcrumbItem onSelected={() => navigate(`/hc`)}>\n            <Trans message=\"Help center\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem onSelected={() => navigate(`/hc/tickets`)}>\n            <Trans message=\"Requests\" />\n          </BreadcrumbItem>\n        </Breadcrumb>\n        <div className=\"mb-34 flex items-start justify-between gap-12\">\n          <h1 className=\"text-3xl font-semibold\">\n            <Trans message=\"My requests\" />\n          </h1>\n          <Button\n            elementType={Link}\n            to=\"/hc/tickets/new\"\n            size=\"sm\"\n            variant=\"outline\"\n          >\n            <Trans message=\"New request\" />\n          </Button>\n        </div>\n        <TicketTable />\n      </main>\n    </div>\n  );\n}\n\nfunction TicketTable() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const {trans} = useTrans();\n  const inputRef = useRef<HTMLInputElement>(null);\n  const navigate = useNavigate();\n  const {user} = useAuth();\n  const query = useTickets({\n    userId: user!.id,\n    query: searchParams.get('query'),\n    tagId: searchParams.get('tagId'),\n    page: searchParams.get('page') || defaultPage,\n    perPage: searchParams.get('perPage') || defaultPerPage,\n  });\n  const data = query.data?.pagination?.data || [];\n  const isFiltering =\n    !!searchParams.get('query') || !!searchParams.get('tagId');\n\n  const setSearchQuery = () => {\n    setSearchParams(prev => {\n      if (inputRef.current?.value) {\n        prev.set('query', inputRef.current.value);\n      } else {\n        prev.delete('query');\n      }\n      return prev;\n    });\n  };\n\n  const content = !data.length ? (\n    <StateMessage isFiltering={isFiltering} />\n  ) : (\n    <Fragment>\n      <Table\n        columns={CustomerTicketTableColumns}\n        data={data}\n        enableSelection={false}\n        onAction={item => navigate(`/hc/tickets/${item.id}`)}\n        cellHeight=\"h-60\"\n      />\n      <DataTablePaginationFooter\n        className=\"mt-12\"\n        query={query}\n        onPageChange={page =>\n          setSearchParams(prev => {\n            prev.set('page', page.toString());\n            return prev;\n          })\n        }\n      />\n    </Fragment>\n  );\n\n  return (\n    <Fragment>\n      <form\n        className=\"mb-34 items-end justify-between gap-24 md:flex\"\n        onSubmit={e => {\n          e.preventDefault();\n          setSearchQuery();\n        }}\n      >\n        <TextField\n          className=\"flex-auto max-md:mb-24\"\n          inputRef={inputRef}\n          defaultValue={searchParams.get('query') || ''}\n          onBlur={() => setSearchQuery()}\n          placeholder={trans(message('Search requests'))}\n          startAdornment={<SearchIcon />}\n        />\n        <StatusSelect />\n      </form>\n      <AnimatePresence initial={false} mode=\"wait\">\n        {query.isLoading ? <Skeletons /> : content}\n      </AnimatePresence>\n    </Fragment>\n  );\n}\n\ninterface StateMessageProps {\n  isFiltering: boolean;\n}\nfunction StateMessage({isFiltering}: StateMessageProps) {\n  return (\n    <DataTableEmptyStateMessage\n      isFiltering={isFiltering}\n      size=\"sm\"\n      className=\"mt-48\"\n      image={searchImage}\n      title={<Trans message=\"You have not created any requests yet\" />}\n      filteringTitle={\n        <Trans message=\"No requests match your search query or filters\" />\n      }\n    />\n  );\n}\n\nfunction StatusSelect() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  return (\n    <Select\n      className=\"flex-shrink-0 md:min-w-172\"\n      selectionMode=\"single\"\n      selectedValue={searchParams.get('tagId') || ''}\n      onSelectionChange={newValue => {\n        setSearchParams(prev => {\n          if (newValue) {\n            prev.set('tagId', `${newValue}`);\n          } else {\n            prev.delete('tagId');\n          }\n          return prev;\n        });\n      }}\n    >\n      <Item value=\"\">\n        <Trans message=\"All requests\" />\n      </Item>\n      <Item value=\"open\">\n        <Trans message=\"Open requests\" />\n      </Item>\n      <Item value=\"closed\">\n        <Trans message=\"Closed requests\" />\n      </Item>\n      <Item value=\"pending\">\n        <Trans message=\"Awaiting your reply\" />\n      </Item>\n    </Select>\n  );\n}\n\nfunction Skeletons() {\n  return (\n    <m.div key=\"skeletons\" {...opacityAnimation}>\n      <Skeleton size=\"h-36\" variant=\"rect\" className=\"mb-12\" />\n      <Skeleton size=\"h-54\" variant=\"rect\" className=\"mb-12\" />\n      <Skeleton size=\"h-54\" variant=\"rect\" />\n    </m.div>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/utils/http/show-http-error-toast';\nimport {toast} from '@common/ui/toast/toast';\nimport {message} from '@common/i18n/message';\nimport {Reply} from '@app/agent/reply';\nimport {useParams} from 'react-router-dom';\nimport {FileEntry} from '@common/uploads/file-entry';\n\ninterface SubmitReplyResponse {\n  reply: Reply;\n}\n\ninterface Payload {\n  body: string | null;\n  attachments?: FileEntry[];\n}\n\nexport function useSubmitCustomerReply() {\n  const {ticketId} = useParams();\n  return useMutation({\n    mutationFn: (payload: Payload) =>\n      submitReply({\n        ticketId: ticketId!,\n        ...payload,\n      }),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({queryKey: ['tickets']});\n      toast(message('Reply submitted'));\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n\nfunction submitReply(data: Payload & {ticketId: number | string}) {\n  const payload = {\n    body: data.body,\n    attachments: data.attachments?.map(a => a.id),\n  };\n  return apiClient\n    .post<SubmitReplyResponse>(`tickets/${data.ticketId}/replies`, payload)\n    .then(r => r.data);\n}\n","import {Navbar} from '@common/ui/navigation/navbar/navbar';\nimport {HcSearchBar} from '@app/help-center/search/hc-search-bar';\nimport React, {Fragment, useRef, useState} from 'react';\nimport {PageStatus} from '@common/http/page-status';\nimport {\n  GetTicketResponse,\n  useTicket,\n} from '@app/agent/agent-ticket-page/requests/use-ticket';\nimport {TicketHeaderDateFormat} from '@app/agent/ticket-layout/ticket-header-layout';\nimport {useTicketReplies} from '@app/agent/agent-ticket-page/reply-list/requests/use-ticket-replies';\nimport {TicketReplyLayout} from '@app/agent/ticket-layout/ticket-reply-layout';\nimport {InfiniteScrollSentinel} from '@common/ui/infinite-scroll/infinite-scroll-sentinel';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {\n  AttachmentListLayout,\n  FileEntryAttachmentLayout,\n} from '@app/agent/ticket-layout/attachment-list-layout';\nimport {BreadcrumbItem} from '@common/ui/breadcrumbs/breadcrumb-item';\nimport {Trans} from '@common/i18n/trans';\nimport {Breadcrumb} from '@common/ui/breadcrumbs/breadcrumb';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {ReplyEditor} from '@app/reply-editor/reply-editor';\nimport {FileUploadProvider} from '@common/uploads/uploader/file-upload-provider';\nimport {useSubmitCustomerReply} from '@app/help-center/tickets/use-submit-customer-reply';\nimport {FormattedRelativeTime} from '@common/i18n/formatted-relative-time';\nimport {FormattedDate} from '@common/i18n/formatted-date';\nimport {Chip} from '@common/ui/forms/input-field/chip-field/chip';\nimport {Button} from '@common/ui/buttons/button';\nimport {ReplyIcon} from '@common/icons/material/Reply';\nimport {TicketTagList} from '@app/agent/ticket-layout/ticket-tag-list';\nimport {Ticket} from '@app/agent/ticket';\nimport {Editor} from '@tiptap/react';\nimport {SendReplyButton} from '@app/reply-editor/send-reply-button';\nimport {useKeybind} from '@common/utils/keybinds/use-keybind';\nimport {SectionHelper} from '@common/ui/section-helper';\nimport {CheckIcon} from '@common/icons/material/Check';\nimport {DialogTrigger} from '@common/ui/overlays/dialog/dialog-trigger';\nimport {ConfirmationDialog} from '@common/ui/overlays/dialog/confirmation-dialog';\nimport {useChangeTicketStatus} from '@app/agent/ticket-actions/requests/use-change-ticket-status';\nimport {useParams} from 'react-router-dom';\nimport {toast} from '@common/ui/toast/toast';\nimport {message} from '@common/i18n/message';\n\nexport function CustomerTicketPage() {\n  const navigate = useNavigate();\n  return (\n    <div>\n      <Navbar menuPosition=\"header\">\n        <HcSearchBar />\n      </Navbar>\n      <div className=\"container mx-auto px-12 pb-48 md:px-24\">\n        <Breadcrumb size=\"sm\" className=\"mb-34 mt-34 md:mb-48\">\n          <BreadcrumbItem onSelected={() => navigate(`/hc`)}>\n            <Trans message=\"Help center\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem onSelected={() => navigate(`/hc/tickets`)}>\n            <Trans message=\"Requests\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem>\n            <Trans message=\"Current ticket\" />\n          </BreadcrumbItem>\n        </Breadcrumb>\n        <main>\n          <Content />\n        </main>\n      </div>\n    </div>\n  );\n}\n\nfunction Content() {\n  const query = useTicket();\n  const [editorIsOpen, setEditorIsOpen] = useState(false);\n  useKeybind('window', 'r', () => setEditorIsOpen(true));\n\n  return (\n    <Fragment>\n      {query.data ? (\n        <Fragment>\n          {query.data.ticket.status === 'locked' && (\n            <SectionHelper\n              className=\"mb-44 text-center\"\n              color=\"danger\"\n              title={\n                <Trans message=\"This ticket was locked due to inactivity. To reply, create a new ticket.\" />\n              }\n            />\n          )}\n          <Header\n            ticket={query.data.ticket}\n            editorIsOpen={editorIsOpen}\n            onOpenEditor={() => setEditorIsOpen(true)}\n          />\n          <FileUploadProvider>\n            {editorIsOpen && (\n              <CustomerReplyEditor onClose={() => setEditorIsOpen(false)} />\n            )}\n          </FileUploadProvider>\n          <ReplyList data={query.data} />\n        </Fragment>\n      ) : (\n        <PageStatus query={query} loaderClassName=\"absolute inset-0 m-auto\" />\n      )}\n    </Fragment>\n  );\n}\n\ninterface CustomerReplyEditorProps {\n  onClose: () => void;\n}\nfunction CustomerReplyEditor({onClose}: CustomerReplyEditorProps) {\n  const editorRef = useRef<Editor | null>(null);\n  const submitReply = useSubmitCustomerReply();\n  const [attachments, setAttachments] = useState<FileEntry[]>([]);\n\n  return (\n    <ReplyEditor\n      isLoading={submitReply.isPending}\n      footerButtons={<SendReplyButton />}\n      editorRef={editorRef}\n      className=\"mb-24\"\n      attachments={attachments}\n      onAttachmentsChange={attachments => setAttachments(attachments)}\n      onSubmit={reply =>\n        submitReply.mutate(reply, {\n          onSuccess: () => onClose(),\n        })\n      }\n    />\n  );\n}\n\ninterface HeaderProps {\n  ticket: Ticket;\n  editorIsOpen: boolean;\n  onOpenEditor: () => void;\n}\nfunction Header({ticket, onOpenEditor, editorIsOpen}: HeaderProps) {\n  return (\n    <div className=\"mb-44\">\n      <div className=\"flex items-center gap-24\">\n        <div className=\"whitespace-nowrap text-muted max-md:hidden\">\n          <FormattedRelativeTime date={ticket.created_at} /> (\n          <FormattedDate\n            date={ticket.created_at}\n            options={TicketHeaderDateFormat}\n          />\n          )\n        </div>\n        <div className=\"text-2xl md:ml-auto\">#{ticket.id}</div>\n        <Chip\n          size=\"sm\"\n          color={!ticket.closed_at ? 'primary' : undefined}\n          radius=\"rounded\"\n          className=\"min-w-60 font-bold capitalize\"\n        >\n          {ticket.status}\n        </Chip>\n      </div>\n      <h1 className=\"my-12 text-2xl\">{ticket.subject}</h1>\n      <div className=\"flex items-center gap-12\">\n        <TicketTagList\n          ticket={ticket}\n          tagType=\"category\"\n          size=\"sm\"\n          radius=\"rounded\"\n          className=\"mr-auto font-semibold max-md:hidden\"\n        />\n        {!ticket.closed_at && <MarkAsSolvedButton />}\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          startIcon={<ReplyIcon />}\n          disabled={editorIsOpen}\n          onClick={() => onOpenEditor()}\n        >\n          <Trans message=\"Add a reply\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\ninterface ReplyListProps {\n  data: GetTicketResponse;\n}\nfunction ReplyList({data: {ticket, replies}}: ReplyListProps) {\n  const query = useTicketReplies(ticket.id, replies);\n  return (\n    <Fragment>\n      {query.items.map(reply => {\n        const isInitial =\n          !query.hasNextPage && reply.id === query.items.at(-1)?.id;\n        return (\n          <TicketReplyLayout\n            className=\"px-12\"\n            key={reply.id}\n            reply={reply}\n            isInitial={isInitial}\n            attachments={\n              reply.attachments?.length ? (\n                <AttachmentList attachments={reply.attachments} />\n              ) : null\n            }\n          />\n        );\n      })}\n      <InfiniteScrollSentinel query={query} />\n    </Fragment>\n  );\n}\n\ninterface AttachmentListProps {\n  attachments: FileEntry[];\n}\nfunction AttachmentList({attachments}: AttachmentListProps) {\n  return (\n    <AttachmentListLayout className=\"mt-30 w-max\">\n      {attachments.map((attachment, index) => (\n        <FileEntryAttachmentLayout\n          key={attachment.id}\n          attachments={attachments}\n          index={index}\n        />\n      ))}\n    </AttachmentListLayout>\n  );\n}\n\nfunction MarkAsSolvedButton() {\n  const changeStatus = useChangeTicketStatus();\n  const {ticketId} = useParams();\n  const navigate = useNavigate();\n  return (\n    <DialogTrigger type=\"modal\">\n      <Button size=\"sm\" variant=\"outline\" startIcon={<CheckIcon />}>\n        <Trans message=\"Mark as solved\" />\n      </Button>\n      {({close}) => (\n        <ConfirmationDialog\n          onConfirm={() => {\n            changeStatus.mutate(\n              {\n                ids: [ticketId!],\n                status: 'closed',\n              },\n              {\n                onSuccess: () => {\n                  close();\n                  toast(message('Ticked marked as solved'));\n                  navigate(`/hc/tickets`);\n                },\n              },\n            );\n          }}\n          isLoading={changeStatus.isPending}\n          title={<Trans message=\"Mark as solved\" />}\n          body={\n            <Trans message=\"Are you sure you want to mark this ticket as solved?\" />\n          }\n          confirm={<Trans message=\"Confirm\" />}\n        />\n      )}\n    </DialogTrigger>\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {TicketTag} from '@app/agent/ticket';\nimport {PaginatedBackendResponse} from '@common/http/backend-response/pagination-response';\n\ninterface Response extends PaginatedBackendResponse<TicketTag> {}\n\nexport function useCustomerTicketCategories() {\n  return useQuery({\n    queryKey: ['new-ticket-categories'],\n    queryFn: () => fetchCategories(),\n  });\n}\n\nfunction fetchCategories() {\n  return apiClient\n    .get<Response>(`ticket-categories`, {\n      params: {\n        perPage: 25,\n        with: 'categories',\n        orderBy: 'name',\n        orderDir: 'asc',\n        filterByPurchases: true,\n        paginate: 'simple',\n      },\n    })\n    .then(response => response.data);\n}\n","import {useSettings} from '@common/core/settings/use-settings';\nimport {CustomerNewTicketPageConfig} from '@app/help-center/tickets/customer-new-ticket-page/customer-new-ticket-page-config';\n\nexport function useCustomerNewTicketConfig() {\n  const settings = useSettings();\n  return (settings.hc?.newTicket?.appearance ||\n    {}) as CustomerNewTicketPageConfig;\n}\n","import {\n  SearchArticlesResponse,\n  useSearchArticles,\n} from '@app/help-center/search/use-search-articles';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {Trans} from '@common/i18n/trans';\nimport {ArticleLink} from '@app/help-center/articles/article-link';\nimport {AccordionAnimation} from '@common/ui/accordion/accordtion-animation';\nimport {MutableRefObject} from 'react';\nimport {SearchSessionItem} from '@app/help-center/search/use-search-term-logger';\nimport {useCurrentDateTime} from '@common/i18n/use-current-date-time';\n\ninterface Props {\n  query: string;\n  suggestionLog: MutableRefObject<SearchSessionItem[]>;\n  hcCategoryIds?: number[];\n}\nexport function SuggestedArticlesDrawer({\n  query,\n  suggestionLog,\n  hcCategoryIds,\n}: Props) {\n  const now = useCurrentDateTime();\n  const handleSearch = (r: SearchArticlesResponse) => {\n    if (r.pagination.data.length) {\n      suggestionLog.current.push({\n        term: r.query,\n        results: r.pagination.data.map(a => a.id),\n        date: now.toAbsoluteString(),\n      });\n    }\n  };\n\n  const {data} = useSearchArticles(\n    query,\n    {perPage: 5, categoryIds: hcCategoryIds},\n    {onSearch: handleSearch},\n  );\n  const results = data?.pagination.data;\n  const isVisible = !!results?.length;\n\n  return (\n    <AnimatePresence>\n      <m.div\n        key=\"drawer\"\n        variants={AccordionAnimation.variants}\n        transition={AccordionAnimation.transition}\n        initial={false}\n        animate={isVisible ? 'open' : 'closed'}\n      >\n        <div className=\"mb-10 mt-24 text-xl font-semibold\">\n          <Trans message=\"Were you looking for\" />:\n        </div>\n        {results?.map(article => (\n          <ArticleLink\n            key={article.id}\n            article={article}\n            className=\"block py-10 text-sm text-primary\"\n            target=\"_blank\"\n          />\n        ))}\n      </m.div>\n    </AnimatePresence>\n  );\n}\n","import {Navbar} from '@common/ui/navigation/navbar/navbar';\nimport {HcSearchBar} from '@app/help-center/search/hc-search-bar';\nimport React, {ReactNode, useRef, useState} from 'react';\nimport {BreadcrumbItem} from '@common/ui/breadcrumbs/breadcrumb-item';\nimport {Trans} from '@common/i18n/trans';\nimport {Breadcrumb} from '@common/ui/breadcrumbs/breadcrumb';\nimport {useNavigate} from '@common/utils/hooks/use-navigate';\nimport {useCustomerTicketCategories} from '@app/help-center/tickets/customer-new-ticket-page/use-customer-ticket-categories';\nimport {useForm} from 'react-hook-form';\nimport {\n  CreateTicketPayload,\n  useCreateTicket,\n} from '@app/agent/agent-new-ticket-page/use-create-ticket';\nimport {Editor} from '@tiptap/react';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {getReplyBody} from '@app/reply-editor/get-reply-body';\nimport {getInputFieldClassNames} from '@common/ui/forms/input-field/get-input-field-class-names';\nimport {Form} from '@common/ui/forms/form';\nimport {FormTextField} from '@common/ui/forms/input-field/text-field/text-field';\nimport {FormSelect} from '@common/ui/forms/select/select';\nimport {Item} from '@common/ui/forms/listbox/item';\nimport {FileUploadProvider} from '@common/uploads/uploader/file-upload-provider';\nimport {ReplyEditor} from '@app/reply-editor/reply-editor';\nimport {Button} from '@common/ui/buttons/button';\nimport {TicketTag} from '@app/agent/ticket';\nimport {useCustomerNewTicketConfig} from '@app/help-center/tickets/customer-new-ticket-page/use-customer-new-ticket-config';\nimport {SuggestedArticlesDrawer} from '@app/help-center/tickets/customer-new-ticket-page/suggested-articles-drawer';\nimport {\n  SearchSessionItem,\n  useSearchTermLogger,\n} from '@app/help-center/search/use-search-term-logger';\nimport {useSettings} from '@common/core/settings/use-settings';\n\nexport function CustomerNewTicketPage() {\n  const navigate = useNavigate();\n  const config = useCustomerNewTicketConfig();\n  const query = useCustomerTicketCategories();\n  const {envato} = useSettings();\n  return (\n    <div>\n      <Navbar menuPosition=\"header\">\n        <HcSearchBar />\n      </Navbar>\n      <div className=\"container mx-auto px-12 pb-48 md:px-24\">\n        <Breadcrumb size=\"sm\" className=\"mb-34 mt-34 md:mb-48\">\n          <BreadcrumbItem onSelected={() => navigate(`/hc`)}>\n            <Trans message=\"Help center\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem onSelected={() => navigate(`/hc/tickets`)}>\n            <Trans message=\"Requests\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem>\n            <Trans message=\"New request\" />\n          </BreadcrumbItem>\n        </Breadcrumb>\n        <div className=\"flex items-stretch gap-44\">\n          <main className=\"flex-auto\">\n            <h1 className=\"mb-34 mt-14 text-3xl font-light\">\n              <Trans message={config!.title} />\n            </h1>\n            {query.error && envato.enable && envato.require_purchase_code && (\n              <EnvatoError />\n            )}\n            {query.data ? (\n              <TicketForm ticketCategories={query.data.pagination.data} />\n            ) : null}\n          </main>\n          <Sidebar />\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface TicketFormProps {\n  ticketCategories: TicketTag[];\n}\nfunction TicketForm({ticketCategories}: TicketFormProps) {\n  const config = useCustomerNewTicketConfig();\n  const navigate = useNavigate();\n  const form = useForm<CreateTicketPayload>({\n    defaultValues: {\n      category_id: ticketCategories[0]?.id,\n    },\n  });\n  const bodyError = form.formState.errors.body?.message;\n  const createTicket = useCreateTicket(form);\n  const editorRef = useRef<Editor | null>(null);\n  const [attachments, setAttachments] = useState<FileEntry[]>([]);\n  const searchQuery = form.watch('subject');\n  const hcCategoryIds = ticketCategories\n    .find(tc => form.watch('category_id') == tc.id)\n    ?.categories.map(hc => hc.id);\n  const searchTermLogger = useSearchTermLogger();\n  const suggestionLog = useRef<SearchSessionItem[]>([]);\n\n  const selectedCategoryId = form.watch('category_id');\n  const selectedCategory = ticketCategories.find(\n    c => c.id == selectedCategoryId,\n  );\n\n  const handleSubmit = () => {\n    createTicket.mutate(\n      {\n        ...form.getValues(),\n        body: getReplyBody(editorRef) || '',\n        attachments: attachments.map(a => a.id),\n        suggestionLog: suggestionLog.current,\n      },\n      {\n        onSuccess: () => {\n          searchTermLogger.updateLastSearch({createdTicket: true});\n          navigate('/hc/tickets');\n        },\n      },\n    );\n  };\n\n  const inputFieldClassNames = getInputFieldClassNames();\n\n  return (\n    <Form\n      form={form}\n      onSubmit={() => handleSubmit()}\n      onBeforeSubmit={() => form.clearErrors()}\n    >\n      <FormSelect\n        name=\"category_id\"\n        label={<Trans message={config!.categoryLabel} />}\n        selectionMode=\"single\"\n        className=\"mb-24\"\n        errorMessage={\n          selectedCategory &&\n          selectedCategory.support_expired && (\n            <Trans\n              message=\"Your support for this item has expired. <a>Click here to renew</a>\"\n              values={{\n                a: content => (\n                  <a\n                    href=\"https://codecanyon.net/downloads\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                    className=\"font-bold underline\"\n                  >\n                    {content}\n                  </a>\n                ),\n              }}\n            />\n          )\n        }\n      >\n        {ticketCategories.map(category => (\n          <Item key={category.id} value={category.id}>\n            {category.display_name || category.name}\n          </Item>\n        ))}\n      </FormSelect>\n      <FormTextField\n        name=\"subject\"\n        label={<Trans message={config!.subjectLabel} />}\n      />\n      <SuggestedArticlesDrawer\n        query={searchQuery}\n        suggestionLog={suggestionLog}\n        hcCategoryIds={hcCategoryIds}\n      />\n      <div className=\"my-24\">\n        <div className={inputFieldClassNames.label}>\n          <Trans message={config!.descriptionLabel} />\n        </div>\n        <FileUploadProvider>\n          <ReplyEditor\n            autoFocus={false}\n            minHeight=\"min-h-[300px]\"\n            isLoading={createTicket.isPending}\n            editorRef={editorRef}\n            attachments={attachments}\n            onAttachmentsChange={attachments => setAttachments(attachments)}\n            onSubmit={() => handleSubmit()}\n          />\n        </FileUploadProvider>\n        {bodyError && (\n          <div className={inputFieldClassNames.error}>{bodyError}</div>\n        )}\n      </div>\n      <Button\n        variant=\"flat\"\n        color=\"primary\"\n        type=\"submit\"\n        disabled={createTicket.isPending}\n      >\n        <Trans message={config!.submitButtonText} />\n      </Button>\n    </Form>\n  );\n}\n\nfunction Sidebar() {\n  const config = useCustomerNewTicketConfig();\n  return (\n    <aside className=\"w-500 border-l px-40 max-md:hidden\">\n      <h2 className=\"mb-34 text-xl font-medium\">\n        <Trans message={config.sidebarTitle} />\n      </h2>\n      {config.sidebarTips?.map((tip, index) => (\n        <SidebarTip key={index} title={<Trans message={tip.title} />}>\n          <Trans message={tip.content} />\n        </SidebarTip>\n      ))}\n    </aside>\n  );\n}\n\ninterface SidebarTipProps {\n  title: ReactNode;\n  children: ReactNode;\n}\nfunction SidebarTip({title, children}: SidebarTipProps) {\n  return (\n    <div className=\"mb-30\">\n      <h3 className=\"text-lg font-medium\">{title}</h3>\n      <p>{children}</p>\n    </div>\n  );\n}\n\nfunction EnvatoError() {\n  return (\n    <div className=\"text-sm text-danger\">\n      <Trans message=\"There was an issue fetching your purchase codes from envato. Try to logout and use 'login with envato' button.\" />\n    </div>\n  );\n}\n","import {RouteObject, useRoutes} from 'react-router-dom';\nimport {NotFoundPage} from '@common/ui/not-found-page/not-found-page';\nimport React from 'react';\nimport {CustomerTicketListPage} from '@app/help-center/tickets/customer-ticket-list-page/customer-ticket-list-page';\nimport {CustomerTicketPage} from '@app/help-center/tickets/customer-ticket-page';\nimport {CustomerNewTicketPage} from '@app/help-center/tickets/customer-new-ticket-page/customer-new-ticket-page';\n\nconst RouteConfig: RouteObject[] = [\n  {\n    path: '/',\n    element: <CustomerTicketListPage />,\n  },\n  {\n    path: '/new',\n    element: <CustomerNewTicketPage />,\n  },\n  {\n    path: ':ticketId',\n    element: <CustomerTicketPage />,\n  },\n  {\n    path: '*',\n    element: <NotFoundPage />,\n  },\n];\n\nexport default function HcTicketRoutes() {\n  return useRoutes(RouteConfig);\n}\n"],"names":["CustomerTicketTableColumns","jsx","Trans","ticket","FormattedRelativeTime","Chip","defaultPage","defaultPerPage","CustomerTicketListPage","navigate","useNavigate","Navbar","HcSearchBar","jsxs","Breadcrumb","BreadcrumbItem","Button","Link","TicketTable","searchParams","setSearchParams","useSearchParams","trans","useTrans","inputRef","useRef","user","useAuth","query","useTickets","data","_b","_a","isFiltering","setSearchQuery","prev","content","Fragment","Table","item","DataTablePaginationFooter","page","StateMessage","e","TextField","message","SearchIcon","StatusSelect","AnimatePresence","Skeletons","DataTableEmptyStateMessage","searchImage","Select","newValue","Item","m","opacityAnimation","Skeleton","useSubmitCustomerReply","ticketId","useParams","useMutation","payload","submitReply","queryClient","toast","err","showHttpErrorToast","a","apiClient","r","CustomerTicketPage","Content","useTicket","editorIsOpen","setEditorIsOpen","useState","useKeybind","SectionHelper","Header","FileUploadProvider","CustomerReplyEditor","ReplyList","PageStatus","onClose","editorRef","attachments","setAttachments","ReplyEditor","SendReplyButton","reply","onOpenEditor","FormattedDate","TicketHeaderDateFormat","TicketTagList","MarkAsSolvedButton","ReplyIcon","replies","useTicketReplies","isInitial","TicketReplyLayout","AttachmentList","InfiniteScrollSentinel","AttachmentListLayout","attachment","index","FileEntryAttachmentLayout","changeStatus","useChangeTicketStatus","DialogTrigger","CheckIcon","close","ConfirmationDialog","useCustomerTicketCategories","useQuery","fetchCategories","response","useCustomerNewTicketConfig","useSettings","SuggestedArticlesDrawer","suggestionLog","hcCategoryIds","now","useCurrentDateTime","handleSearch","useSearchArticles","results","isVisible","AccordionAnimation","article","ArticleLink","CustomerNewTicketPage","config","envato","EnvatoError","TicketForm","Sidebar","ticketCategories","form","useForm","bodyError","createTicket","useCreateTicket","searchQuery","_c","tc","hc","searchTermLogger","useSearchTermLogger","selectedCategoryId","selectedCategory","c","handleSubmit","getReplyBody","inputFieldClassNames","getInputFieldClassNames","Form","FormSelect","category","FormTextField","tip","SidebarTip","title","children","RouteConfig","NotFoundPage","HcTicketRoutes","useRoutes"],"mappings":"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"}